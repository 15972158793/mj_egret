var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),CardGroupShowTop=function(e){function t(){var t=e.call(this)||this;return t.cardIndex=0,t.cards=[],t.skinName="resource/skins/card/CardGroupShowTopSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onAddCard=function(e,t){void 0===t&&(t=!1),this.parent.M_PlayersCurOutCard=null;var i=new Card(Statics.CARD_TYPE_SHOW_TOP);this.parent.M_PlayersCurOutCard=i,i.SetFaceNumber=e,this.cardIndex<11?(i.y=103,i.x=495-45*(this.cardIndex+1)):this.cardIndex<22?(i.y=52,i.x=495-45*(this.cardIndex+1-11)):(i.y=1,i.x=495-45*(this.cardIndex+1-22)),this.g_card.addChildAt(i,0),this.cards.push(i),this.cardIndex++,t&&(i.card.source=RES.getRes("card_hide_bottom_png"))},t.prototype.onAddHideCard=function(){var e=new Card(Statics.CARD_TYPE_HIDE_TOP);this.cardIndex<11?(e.y=103,e.x=495-45*(this.cardIndex+1)):this.cardIndex<22?(e.y=52,e.x=495-45*(this.cardIndex+1-11)):(e.y=1,e.x=495-45*(this.cardIndex+1-22)),this.g_card.addChildAt(e,0),this.cards.push(e),this.cardIndex++},t.prototype.OffOnLineCome=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++)t-1==i?this.onAddCard(e[i],!0):this.onAddCard(e[i],!1)},t}(eui.Component);__reflect(CardGroupShowTop.prototype,"CardGroupShowTop");var AlertButtonPage=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName="resource/skins/AlertButtonSkin.exml",n.content=t,n.type=i,n}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.once(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.lb_content.text=this.content,this["g_btn"+this.type].visible=!0,this.btn_no.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnPre,this),this.btn_no2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnPre,this),this.btn_yes.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnNext,this),this.btn_yes2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnNext,this),this.btn_yes3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnNext,this)},t.prototype.onRemoveStage=function(){this.btn_no.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnPre,this),this.btn_no2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnPre,this),this.btn_yes.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnNext,this),this.btn_yes2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnNext,this),this.btn_yes3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnNext,this),this&&this.parent&&this.parent.removeChild(this)},t.prototype.onBtnPre=function(){this.dispatchEvent(new egret.Event(EventName.BTN_CHOOSE_PRE)),this.onRemoveStage()},t.prototype.onBtnNext=function(){this.dispatchEvent(new egret.Event(EventName.BTN_CHOOSE_NEXT)),this.onRemoveStage()},t}(eui.Component);__reflect(AlertButtonPage.prototype,"AlertButtonPage");var EventName=function(){function e(){}return e.CREATE_PAGE_USERINFO="createPageUserInfo",e.CREATE_PAGE_MESSAGE="createPageMessage",e.CREATE_PAGE_ROOMLIST="createPageRoomlist",e.CREATE_PAGE_CODE="createPageCode",e.CREATE_PAGE_SCORE="createPageScore",e.CREATE_PAGE_SERVER="createPageServer",e.CREATE_PAGE_HOW="createPageHow",e.CREATE_PAGE_SET="createPageSET",e.CREATE_PAGE_CREATE="createPageCreate",e.CREATE_PAGE_JOIN="createPageJoin",e.CREATE_PAGE_SHOP="createPageShop",e.CREATE_PAGE_GAME="createPageGame",e.CREATE_PAGE_TALK="createPageTalk",e.CREATE_PAGE_RECORD="createPageRecord",e.CREATE_PAGE_RETURN="createPageReturn",e.REMOVE_HALL="removeHall",e.REMOVE_TABLE="removeTable",e.SEND_FACE="sendFace",e.SEND_TALK="sendTalk",e.BTN_CHOOSE_PRE="btnChoosePre",e.BTN_CHOOSE_NEXT="btnChooseNext",e.BTN_CHOOSE_OK="btnChooseOk",e.BTN_SITDOWN="btnSitdown",e.REMOVEJOIN="removejoin",e}();__reflect(EventName.prototype,"EventName");var Loading_UI=function(e){function t(t,i){var n=e.call(this)||this;return n.width=t,n.height=i,n}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0},t.prototype.setProgress=function(e,t){IframeManager.getInstance().sendMessage({forLobby:!0,cmd:"loading",percent:e/t*.5+.5})},t}(eui.Component);__reflect(Loading_UI.prototype,"Loading_UI");var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),RES.web.Html5VersionController.prototype.getVirtualUrl=function(e){return e+="?v="+window.resVersion};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig(window.ossServer+"resource/default.res.json",window.ossServer+"resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.setMaxLoadingThread(6),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading"),this.loadingView=new Loading_UI(this.width,this.height),this.addChildAt(this.loadingView,1)},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,RES.loadGroup("sound")},t.prototype.onResourceLoadComplete=function(e){if("preload"==e.groupName)this.removeChild(this.loadingView),this.isResourceLoadEnd=!0,this.createScene();else if("loading"==e.groupName){var t=new eui.Image;t.source=RES.getRes("desk_bg_png"),this.addChildAt(t,0),t.left=t.right=t.top=t.bottom=0;var i=new eui.Theme(window.ossServer+"resource/default.thm.json",this.stage);i.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)}else"sound"==e.groupName&&(Sound.isResComplete=!0,this.initSound())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName?this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal):"loading"==e.groupName},t.prototype.initSound=function(){this.MiansetSoundOn()},t.prototype.MiansetSoundOn=function(){this.loadingView.visible=!0,RES.loadGroup("preload")},t.prototype.startCreateScene=function(){egret.Capabilities.isMobile&&(this.stage.orientation=egret.OrientationMode.LANDSCAPE_FLIPPED),this.stage.setContentSize(1206,750),new MainSceneManager(this)},t.prototype.test=function(){var e="1和呵呵h和和bc";console.log(FishUtil.limitNick(e))},t}(eui.UILayer);__reflect(Main.prototype,"Main");var MainSceneManager=function(){function e(e){this.playersdate=new egret.Event(NetData.CODE_UPDATA_ROOM.toString()),Global.mainScene=this,this.rootLayer=e,this.gameLayer=new eui.UILayer,this.rootLayer.addChild(this.gameLayer),IframeManager.getInstance().sendMessage({cmd:"ready",forLobby:!0})}return e.prototype.init=function(){this.initSocketListener(),Player.getUrlInfo(),console.log(JSON.stringify(Player.USERINFO));var e={cmd:NetData.CODE_JOIN_BY_INPUT,roomId:Player.USERINFO.roomId,flag:1};SocketUtil.getInstance().onSendMessage(e);var t=egret.localStorage.getItem("kdmj_music");if(t){var i=JSON.parse(t);Sound.isPlay=i[0],Sound.getInstance().Switch=i[0],Sound.getInstance().effectVolume=i[1]?.8:0,console.log("获取配置 -- ",i)}},e.prototype.onCreateHall=function(){this.initSocketListener()},e.prototype.onRemoveHall=function(){},e.prototype.initSocketListener=function(){NetData.addEvt(NetData.CODE_SCORE_PAGE,this.onCreateScore,this),NetData.addEvt(NetData.CODE_GAME_OffLineImg,this.onCreateRoomlist,this),NetData.addEvt(NetData.CODE_ROOM_Line_On,this.RoomLineOn,this),NetData.addEvt(NetData.CODE_GAME_Line_On,this.GameLineOn,this),NetData.addEvt(NetData.CODE_ROOM_INFO,this.onUpdateRoomInfo,this),NetData.addEvt(NetData.CODE_Game_Record,this.OnNetRecord,this),NetData.addEvt(NetData.CODE_Game_UpDateSelfSocre,this.UpDateSelfSocre,this)},e.prototype.OnNetRecord=function(e){IframeManager.getInstance().downloadRecord(e.data[0].record),null!=this.tablePage?this.tablePage.ShowVoice(e.data[0].index):null!=this.gamePage&&this.gamePage.ShowVoice(e.data[0].index)},e.prototype.HideRecord=function(){null!=this.tablePage?this.tablePage.HideVoice():null!=this.gamePage&&this.gamePage.HideVoice()},e.prototype.UpDateSelfSocre=function(e){Player.PlayerScore=e.data[0].score},e.prototype.RoomLineOn=function(e){Global.RoomLineOnDate=e.data,Global.isGameStart=e.data[0].gameStart,this.playersdate.data=e.data[0].players,Room.NUMBER=e.data[0].room.roomId,Room.TIMES=e.data[0].room.times,Room.ALL_TIMES=e.data[0].room.allTimes,Room.RULE=e.data[0].room,Player.isMaster=Player.USERINFO.roleId==e.data[0].room.createPlayer.roleId?!0:!1,Player.OPENID=Player.USERINFO.roleId,this.tablePage||(this.tablePage=new TablePage(!0),this.gameLayer.addChild(this.tablePage)),this.tablePage.addEventListener(EventName.REMOVE_TABLE,this.onRemoveTable,this),this.tablePage.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveTable,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_HOW,this.onCreateHow,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_SET,this.onCreateSet,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_GAME,this.onCreateGame,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_TALK,this.onCreateTalk,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_RECORD,this.onCreateVoice,this)},e.prototype.GameLineOn=function(e){console.log("--------------------------------------"),Room.RoomPlayerInfo=e.data[0].players,Room.NUMBER=e.data[0].players[0].roomId,Room.TIMES=e.data[0].room.times,Room.ALL_TIMES=e.data[0].room.allTimes,Room.RULE=e.data[0].room,Room.FENG_CARD=e.data[0].fengCard,Player.SeatNumber=e.data[0].players[0].index,Player.isMaster=e.data[0].players[0].roomMaster,Player.isRoomCreated=e.data[0].players[0].roomMaster,Player.PlayerScore=e.data[0].players[0].score,Player.NickName=e.data[0].players[0].nickname,Player.HeadImg=e.data[0].players[0].headImgUrl,Player.OPENID=e.data[0].players[0].roleId,null==this.gamePage&&(console.log("走这个：new GamePage -- "+e.data[0].remainCardSize),this.gamePage=new GamePage(e.data[0].remainCardSize),this.gameLayer.addChild(this.gamePage)),this.onRemoveTable(),this.gamePage.addEventListener(EventName.CREATE_PAGE_SET,this.onCreateSet,this),this.gamePage.addEventListener(EventName.CREATE_PAGE_TALK,this.onCreateTalk,this),this.gamePage.addEventListener(EventName.CREATE_PAGE_RECORD,this.onCreateVoice,this),this.gamePage.OffOnLineCome(e.data[0].infos,e.data[0].nowPutCardIndex)},e.prototype.onCreateTable=function(){this.tablePage||(console.log("创建桌子"),this.tablePage=new TablePage,this.gameLayer.addChild(this.tablePage)),this.tablePage.addEventListener(EventName.REMOVE_TABLE,this.onRemoveTable,this),this.tablePage.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveTable,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_HOW,this.onCreateHow,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_SET,this.onCreateSet,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_GAME,this.onCreateGame,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_TALK,this.onCreateTalk,this),this.tablePage.addEventListener(EventName.CREATE_PAGE_RECORD,this.onCreateVoice,this)},e.prototype.onRemoveTable=function(){this.tablePage&&this.tablePage.parent&&(this.tablePage.removeEventListener(EventName.REMOVE_TABLE,this.onRemoveTable,this),this.tablePage.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveTable,this),this.tablePage.removeEventListener(EventName.CREATE_PAGE_HOW,this.onCreateHow,this),this.tablePage.removeEventListener(EventName.CREATE_PAGE_SET,this.onCreateSet,this),this.tablePage.removeEventListener(EventName.CREATE_PAGE_TALK,this.onCreateTalk,this),this.tablePage.removeEventListener(EventName.CREATE_PAGE_RECORD,this.onCreateVoice,this),this.tablePage.parent.removeChild(this.tablePage),this.tablePage=null)},e.prototype.onCreateGame=function(){null==this.gamePage&&(console.log("走这个：new GamePage"),this.gamePage=new GamePage,this.gameLayer.addChild(this.gamePage)),this.onRemoveTable(),this.gamePage.addEventListener(EventName.CREATE_PAGE_SET,this.onCreateSet,this),this.gamePage.addEventListener(EventName.CREATE_PAGE_TALK,this.onCreateTalk,this),this.gamePage.addEventListener(EventName.CREATE_PAGE_RECORD,this.onCreateVoice,this)},e.prototype.onRemoveGame=function(){this.gamePage&&this.gamePage.parent&&(this.gamePage.c_timeArrow.removeArrowListener(),egret.Tween.removeTweens(this.gamePage.c_card_bottom),this.gamePage.removePageListener(),this.gamePage.removeEventListener(EventName.CREATE_PAGE_SET,this.onCreateSet,this),this.gamePage.removeEventListener(EventName.CREATE_PAGE_TALK,this.onCreateTalk,this),this.gamePage.removeEventListener(EventName.CREATE_PAGE_RECORD,this.onCreateVoice,this),this.gamePage.parent.removeChild(this.gamePage),this.gamePage=null,console.log("移除gamePage"))},e.prototype.onCreateEnd=function(){this.endPage||(this.endPage=new GameEndPage,this.gameLayer.addChild(this.endPage),this.timers=new egret.Timer(15e3,1),this.timers.addEventListener(egret.TimerEvent.TIMER,this.onTimershow,this),this.timers.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timers.start())},e.prototype.onTimershow=function(){console.log("开始计时")},e.prototype.timerComFunc=function(){Global.isGameStart=!0,Global.mainScene.onRemoveEnd(),Room.TIMES>1&&(Global.mainScene.onRemoveGame(),Global.mainScene.onCreateTable(),Global.mainScene.tablePage.IshowBt()),null!=Global.mainScene.tablePage&&Global.mainScene.tablePage.IshowBt();var e={cmd:NetData.CODE_GAME_CONTINUE,msg:[{roomId:Room.NUMBER,times:Room.TIMES}]};SocketUtil.getInstance().onSendMessage(e),console.log(e)},e.prototype.onRemoveEnd=function(){this.endPage&&this.endPage.parent&&(this.endPage.parent.removeChild(this.endPage),this.endPage=null,this.timers.stop())},e.prototype.onCreateBigEnd=function(){this.BigEndPage||(this.BigEndPage=new GameBigEndPage,this.gameLayer.addChild(this.BigEndPage))},e.prototype.onRemoveBigEnd=function(){this.BigEndPage&&this.BigEndPage.parent&&(this.BigEndPage.parent.removeChild(this.BigEndPage),this.BigEndPage=null)},e.prototype.onCreateUserInfo=function(){this.gamehalluserinfo=new Page_UserInfo,this.gameLayer.addChild(this.gamehalluserinfo)},e.prototype.onCreateRoomlist=function(e){var t=new Page_RoomList;console.log("房间列表",e.data),t.ListDate(e.data),this.gameLayer.addChild(t)},e.prototype.onCreateScore=function(e){var t=new Page_Score;console.log("战绩数据:"+JSON.stringify(e.data[0])),t.ReadData(e.data[0]),this.gameLayer.addChild(t)},e.prototype.onCreateServer=function(){this.gameLayer.addChild(new Page_Server)},e.prototype.onCreateHow=function(){this.gameLayer.addChild(new Page_How)},e.prototype.onCreateSet=function(){this.gameLayer.addChild(new Page_Set)},e.prototype.onCreateShop=function(){this.gameLayer.addChild(new Page_Shop)},e.prototype.onCreateJoin=function(){e.Page_Join=new Page_Join,e.Page_Join.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){e.Page_Join=null},this),this.gameLayer.addChild(e.Page_Join)},e.prototype.onCreateReturn=function(){console.log("返回房间");var e={cmd:NetData.CODE_BACK_ROOM,msg:[{roomId:Room.NUMBER}]};NetData.addEvt(NetData.CODE_BACK_ROOM,this.onGetRoomInfo,this),SocketUtil.getInstance().onSendMessage(e)},e.prototype.onCreateTalk=function(){this.gameLayer.addChild(new Page_Chat)},e.prototype.onCreateVoice=function(){this.gameLayer.addChild(new Page_Record)},e.prototype.onCreateErrorAlert=function(e){e==NetData.CODE_ERROR_CREATE_ROOM?this.gameLayer.addChild(new AlertPage("创建房间失败")):e==NetData.CODE_ERROR_JOIN_ROOM?this.gameLayer.addChild(new AlertPage("加入房间失败")):e==NetData.CODE_ERROR_NO_MONEY&&this.gameLayer.addChild(new AlertPage("金币不足"))},e.prototype.onCreateAlert=function(e){var t=new AlertPage(e);this.gameLayer.addChild(t)},e.prototype.onGetRoomInfo=function(e){NetData.removeEvt(NetData.CODE_BACK_ROOM,this.onGetRoomInfo,this),Room.RoomPlayerInfo=e.data,this.onCreateTable()},e.prototype.onUpdateRoomInfo=function(e){Room.NUMBER=e.data[0].roomId,Room.TIMES=e.data[0].times,Room.ALL_TIMES=e.data[0].allTimes,Room.RULE=e.data[0]},e.prototype.showAlert=function(e,t,i){var n=new AlertPage(e);t&&n.once(EventName.BTN_CHOOSE_OK,t,i),this.gameLayer.addChild(n)},e}();__reflect(MainSceneManager.prototype,"MainSceneManager");var Sound=function(){function e(){this.bgmVolume=.5,this.effectVolume=.8}return Object.defineProperty(e.prototype,"Switch",{get:function(){return this._Switch},set:function(e){this._Switch=e,e?this.playBgm():this.stopBgm()},enumerable:!0,configurable:!0}),e.prototype.playBgm=function(){if(e.isResComplete&&e.isPlay){if(e.isPlaying)return;this.bgm=RES.getRes("bgm_mp3"),this.bgmChannel=this.bgm.play(0,0),this.bgmChannel.volume=1,e.isPlaying=!0}},e.prototype.playerEffc=function(e){if(0!=this.effectVolume){var t=RES.getRes(e+"_mp3"),i=t.play(0,1);i.volume=this.effectVolume}},e.prototype.stopBgm=function(){this.bgm&&this.bgmChannel.stop(),e.isPlay=!1,e.isPlaying=!1,console.log(e.isPlay)},e.prototype.SetBgmVolume=function(e){this.bgmChannel.volume=e},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.SoundNum=.5,e}();__reflect(Sound.prototype,"Sound");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function o(e){t.call(n,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Global=function(){function e(){}return e.CheckTalk=function(t){for(var i=-1,n=0;n<e.talks.length;n++)t==e.talks[n]&&(i=n);return i},e.GameVoice="",e.GameVoiceServer="",e.talks=["大家好，很高兴见到各位！","快点吧，我等到花儿都谢了。","不要走，决战到天亮。","君子报仇，十盘不算晚。","快放炮吧，我都等得不耐烦了。","真不好意思，又胡了。","打错了，呜呜呜呜。"],e.isGameStart=!1,e}();__reflect(Global.prototype,"Global");var Player=function(){function e(){}return e.onSeat=function(t){if(1==e.SeatNumber){if(2==t)return"right";if(3==t)return"top";if(4==t)return"left";if(t==e.SeatNumber)return"bottom"}else if(2==e.SeatNumber){if(1==t)return"left";if(3==t)return"right";if(4==t)return"top";if(t==e.SeatNumber)return"bottom"}else if(3==e.SeatNumber){if(1==t)return"top";if(2==t)return"left";if(4==t)return"right";if(t==e.SeatNumber)return"bottom"}else if(4==e.SeatNumber){if(1==t)return"right";if(2==t)return"top";if(3==t)return"left";if(t==e.SeatNumber)return"bottom"}},e.onPSeat=function(e){return 2==e?"right":3==e?"top":4==e?"left":1==e?"bottom":void 0},e.onResetPlayer=function(){e.SeatNumber=null,e.isMaster=!1,e.isRoomCreated=!1},e.getUrlInfo=function(){for(var t=document.location.href,i=t.split("?"),n=i[1].split("&"),o={},a=0;a<n.length;a++){var r=n[a].split("=")[0],s=n[a].split("=")[1];o[r]=s}e.USERINFO=o},e.ID=123456,e.sex=1,e.OPENID="1234",e.NickName="史丹利",e.HeadImg="http://i0.hdslb.com/bfs/face/d0dad8800774a4903547b1326d1fd927df47b4e9.jpg@68w_68h.webp",e.Money=1e3,e.SeatNumber=0,e.isMaster=!1,e.recommandCode="0",e.HandCard=[],e.USERINFO={},e}();__reflect(Player.prototype,"Player");var Room=function(){function e(){}return e.onGetRule=function(e){var t="";return 0==e||(1==e?t+="普通场":2==e&&(t+="风耗子场")),t},e.onResetRoom=function(){e.RULE=null,e.TIMES=null,e.ALL_TIMES=null,e.NUMBER=null,e.FENG_CARD=null},e.activityInfo="",e.FENG_CARD=-1,e}();__reflect(Room.prototype,"Room");var Statics=function(){function e(){}return e.CARD_TYPE_SELF="cardTypeSelf",e.CARD_TYPE_LEFT="cardTypeLeft",e.CARD_TYPE_RIGHT="cardTypeRight",e.CARD_TYPE_TOP="cardTypeTop",e.CARD_TYPE_SHOW_TOP="cardTypeShowTop",e.CARD_TYPE_SHOW_BOTTOM="cardTypeShowBottom",e.CARD_TYPE_SHOW_LEFT="cardTypeShowLeft",e.CARD_TYPE_SHOW_RIGHT="cardTypeShowRight",e.CARD_TYPE_SHOW_SELF="cardTypeShowSelf",e.CARD_TYPE_HIDE_TOP="cardTypeHideTop",e.CARD_TYPE_HIDE_LEFT="cardTypeHideLeft",e.CARD_TYPE_HIDE_RIGHT="cardTypeHideRight",e.ARROW_TOP="top",e.ARROW_BOTTOM="bottom",e.ARROW_LEFT="left",e.ARROW_RIGHT="right",e.GE_TYPE_PENG="GEtypePeng",e.GE_TYPE_GANG_MING="GEtypeGangMing",e.GE_TYPE_GANG_AN="GEtypeGangAn",e.GE_TYPE_HU="GEtypeHu",e.GE_TYPE_GUO="GEtypeGuo",e.ScoreDate=[{date:"",time:"",roomId:"",playerOneName:"",playerOneValue:"",playerTwoName:"",playerTwoValue:"",playerThreeName:"",playerThreeValue:"",playerFourName:"",playerFourValue:""}],e.RListDate=[{alltimes:"",roomid:"",size:""}],e.IsSecond=!1,e}();__reflect(Statics.prototype,"Statics");var GetSocketMsg=function(){function e(){this.list=[NetData.CODE_JOIN_BY_INPUT,NetData.CODE_ERROR,NetData.CODE_JOIN_ROOM_SUCCESS,NetData.CODE_ROOM_INFO,NetData.CODE_BACK_ROOM,NetData.CODE_BACK_BY_EXIT,NetData.CODE_UPDATA_ROOM,NetData.CODE_BREAK_ROOM,NetData.CODE_GAME_START,NetData.CODE_GAME_ADD_CARD_BY_SELF,NetData.CODE_GAME_PUT_CARD,NetData.CODE_GAME_AWRROW,NetData.CODE_GAME_EVENT_TING,NetData.CODE_GAME_EVENT_HU,NetData.CODE_GAME_EVENT_SELECTED_TING,NetData.CODE_GAME_EVENT_SURE_TING,NetData.CODE_GAME_EVENT_SHOW_CARD,NetData.CODE_GAME_EVENT_PENG,NetData.CODE_GAME_EVENT_SERVER_PENG,NetData.CODE_PLAYER_CHAT,NetData.CODE_SCORE_PAGE,NetData.CODE_GAME_EVENT_GANG,NetData.CODE_GAME_EVENT_SURE_HU,NetData.CODE_GAME_EVENT_SERVER_GANG,NetData.CODE_GAME_LIUJU,NetData.CODE_BIG_END,NetData.CODE_GAME_OffLineImg,NetData.CODE_GAME_OnLineImg,NetData.CODE_ROOM_Line_On,NetData.CODE_GAME_Line_On,NetData.CODE_SomePlayer_Exit,NetData.CODE_Game_CanExit,NetData.CODE_Game_isvalidation,NetData.CODE_Game_validation,NetData.CODE_Game_Record,NetData.CODE_Game_UpDateSelfSocre,NetData.CODE_Game_mayCheat,NetData.CODE_SIT_DOWN,NetData.CODE_OTHER_SIT_DOWN,NetData.CODE_STAND_UP,NetData.CODE_GAME_FENG,NetData.CODE_TS,NetData.CODE_TS_TWO],this.errorList=[NetData.CODE_ERROR_CREATE_ROOM,NetData.CODE_ERROR_JOIN_ROOM,NetData.CODE_ERROR_NO_MONEY]}return e.prototype.onMsg=function(e){console.log("onMsg",e);for(var t=0;t<this.list.length;t++)if(e.cmd==this.list[t])if(e.cmd==NetData.CODE_ERROR){console.log("错误");var i=e.msg[0].cmd;console.log(i),i==NetData.CODE_ERROR_CREATE_ROOM?(console.log("创建房间失败"),Global.mainScene.onCreateErrorAlert(i)):i==NetData.CODE_ERROR_JOIN_ROOM?(console.log("加入房间失败"),Global.mainScene.onCreateErrorAlert(i)):i==NetData.CODE_ERROR_NO_MONEY&&(console.log("金币不足"),Global.mainScene.onCreateErrorAlert(i))}else NetData.dispatchEvt(this.list[t],e.msg||e),this.list[t]==NetData.CODE_BIG_END&&console.log("数据 -- "+e.msg)},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e}();__reflect(GetSocketMsg.prototype,"GetSocketMsg");var IframeManager=function(e){function t(){var t=e.call(this)||this;return window.addEventListener("message",t.getMessage,!1),t}return __extends(t,e),t.getInstance=function(){return null==this.ins&&(this.ins=new t),this.ins},t.prototype.getMessage=function(e){var i=e.data;if(console.log("接收网络消息 -- ",JSON.stringify(i)),console.log("接收网络消息 -- ",JSON.stringify(e.data.forLobby)),e.data.forLobby){var n=null;switch(e.data.cmd){case"ready":Global.mainScene.init();break;case"room":SocketUtil.getInstance().onReceiveMessage(n);break;case"offline":Global.mainScene.showAlert("您已断开与服务器的连接，请连接网络后刷新页面",t.getInstance().flushFrame,t.getInstance());break;case NetConstant.SHARE_SUCCESS:break;case NetConstant.SHARE_FAIL:break;case NetConstant.SHARE_CANCEL:break;case NetConstant.STOP_RECORD_SUCCESS:n=e.data.localId;break;case NetConstant.STOP_RECORD_FAIL:break;case NetConstant.UPLOAD_VOICE_SUCCESS:n=e.data.serverId;break;case NetConstant.UPLOAD_VOICE_FAIL:break;case NetConstant.START_RECORD_SUCCESS:break;case NetConstant.START_RECORD_FAIL:break;case NetConstant.DOWNLOAD_VOICE_SUCCESS:n=e.data.localId;break;case NetConstant.DOWNLOAD_VOICE_FAIL:break;case NetConstant.PLAY_VOICE_SUCCESS:break;case NetConstant.PLAY_VOICE_FAIL:}t.getInstance().dispatchEventWith(e.data.cmd,!1,n)}else console.log("接收socket msg：",i),SocketUtil.getInstance().onReceiveMessage(i)},t.prototype.sendMessage=function(e){"loading"!=e.cmd&&console.log("发送网络消息 -- ",JSON.stringify(e)),window.parent.postMessage(e,"*")},t.prototype.getDataByParent=function(){},t.prototype.sendToParent=function(){},t.prototype.getDataFromIframe=function(){this.sendMessage({forLobby:!0,cmd:"room"})},t.prototype.backToHall=function(){this.sendMessage({forLobby:!0,cmd:"close"})},t.prototype.sendUILoadFinish=function(){this.sendMessage({forLobby:!0,cmd:"ready"})},t.prototype.flushFrame=function(){this.sendMessage({forLobby:!0,cmd:"refresh"})},t.prototype.startRecord=function(){this.sendMessage({forLobby:!0,cmd:"wx",func:"startRecord"})},t.prototype.stopRecord=function(e){void 0===e&&(e=0),this.sendMessage({forLobby:!0,cmd:"wx",func:"stopRecord",type:e})},t.prototype.downloadRecord=function(e){this.sendMessage({forLobby:!0,cmd:"wx",func:"downloadVoice",serverId:e})},t.prototype.playRecord=function(e){this.sendMessage({forLobby:!0,cmd:"wx",func:"playVoice",serverId:e})},t.prototype.initWxShare=function(e,t,i){this.sendMessage({forLobby:!0,cmd:"wx",func:"initShare",title:e,desc:t,imgUrl:i})},t}(eui.Component);__reflect(IframeManager.prototype,"IframeManager");var NetConstant=function(){function e(){}return e.SHARE_SUCCESS="shareSuccess",e.SHARE_FAIL="shareFail",e.SHARE_CANCEL="shareCancel",e.STOP_RECORD_SUCCESS="stopRecordSuccess",e.STOP_RECORD_FAIL="stopRecordFail",e.UPLOAD_VOICE_SUCCESS="uploadVoiceSuccess",e.UPLOAD_VOICE_FAIL="uploadVoiceFail",e.START_RECORD_SUCCESS="startRecordSuccess",e.START_RECORD_FAIL="startRecordFail",e.DOWNLOAD_VOICE_SUCCESS="downloadVoiceSuccess",e.DOWNLOAD_VOICE_FAIL="downloadVoiceFail",e.PLAY_VOICE_SUCCESS="playVoiceSuccess",e.PLAY_VOICE_FAIL="playVoiceFail",e}();__reflect(NetConstant.prototype,"NetConstant");var NetData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.dispatchEvt=function(e,i){t.getInstance().dispatchEventWith(e,!1,i)},t.addEvt=function(e,i,n){t.getInstance().addEventListener(e,i,n)},t.removeEvt=function(e,i,n){t.getInstance().removeEventListener(e,i,n)},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.CODE_JOIN_BY_INPUT=160002,t.CODE_JOIN_ROOM_SUCCESS=160028,t.CODE_SIT_DOWN=161200,t.CODE_OTHER_SIT_DOWN=161201,t.CODE_STAND_UP=161300,t.CODE_BACK_BY_EXIT=160003,t.CODE_BACK_ROOM=160024,t.CODE_BREAK_ROOM=160019,t.CODE_UPDATA_ROOM=160029,t.CODE_GAME_START=160005,t.CODE_TS=161500,t.CODE_TS_TWO=161501,t.CODE_GAME_CONTINUE=160026,t.CODE_GAME_FENG=161100,t.CODE_GAME_ADD_CARD_BY_SELF=160007,t.CODE_GAME_AWRROW=160036,t.CODE_GAME_PUT_CARD=160008,t.CODE_ROOM_INFO=160009,t.CODE_GAME_EVENT_PENG=160010,t.CODE_GAME_EVENT_SURE_PENG=160037,t.CODE_GAME_EVENT_SERVER_PENG=160027,t.CODE_GAME_EVENT_GANG=160011,t.CODE_GAME_EVENT_SURE_GANG=160038,t.CODE_GAME_EVENT_SERVER_GANG=160034,t.CODE_GAME_EVENT_HU=160012,t.CODE_GAME_EVENT_SURE_HU=160039,t.CODE_GAME_EVENT_SHOW_CARD=160016,t.CODE_GAME_EVENT_TING=160013,t.CODE_GAME_EVENT_SELECTED_TING=160040,t.CODE_GAME_EVENT_SURE_TING=160032,t.CODE_GAME_EVENT_GUO=160014,t.CODE_PLAYER_CHAT=160015,t.CODE_ERROR=160020,t.CODE_ERROR_CREATE_ROOM=160021,t.CODE_ERROR_JOIN_ROOM=160022,t.CODE_ERROR_NO_MONEY=160023,t.CODE_SCORE_PAGE=160041,t.CODE_BIG_END=160043,t.CODE_ROOM_Line_On=160060,t.CODE_GAME_Line_On=160061,t.CODE_GAME_LIUJU=160070,t.CODE_GAME_OffLineImg=161e3,t.CODE_GAME_OnLineImg=10001,t.CODE_SomePlayer_Exit=160090,t.CODE_Game_CanExit=160092,t.CODE_Game_isvalidation=160091,t.CODE_Game_validation=160093,t.CODE_Game_Record=160888,t.CODE_Game_UpDateSelfSocre=168888,t.CODE_Game_mayCheat=169999,t}(egret.EventDispatcher);__reflect(NetData.prototype,"NetData");var SocketUtil=function(){function e(){}return e.prototype.onSendMessage=function(e){IframeManager.getInstance().sendMessage(JSON.stringify(e))},e.prototype.onReceiveMessage=function(e){if(console.log("-----SOKETMSG-----",e),e.errorCode)switch(e.errorCode){case 1612001:Global.mainScene.showAlert("您已经坐下")}else GetSocketMsg.getInstance().onMsg(e.msg||e)},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e}();__reflect(SocketUtil.prototype,"SocketUtil");var AlertPage=function(e){function t(t){var i=e.call(this)||this;return i.skinName="resource/skins/AlertSkin.exml",i.content=t,i}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.btn_ok.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOk,this),this.lb_content.text=this.content},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.btn_ok.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOk,this),this&&this.parent&&this.parent.removeChild(this)},t.prototype.onOk=function(){this.dispatchEvent(new egret.Event(EventName.BTN_CHOOSE_OK)),this.onRemoveStage()},t}(eui.Component);__reflect(AlertPage.prototype,"AlertPage");var AlertValidation=function(e){function t(t,i){void 0===i&&(i=!1);var n=e.call(this)||this;return n.step=t,n.isFirst=i,n.skinName="resource/skins/AlertValidationSkin.exml",n}return __extends(t,e),t.prototype.childrenCreated=function(){this["g_step"+this.step].visible=!0,this.isFirst&&(this.txt_tip.text="游戏未开始，解散房间不会扣除元宝，您确定要解散房间吗？"),this.addEvent()},t.prototype.onTimer=function(){this.img_pgs.width=this.img_pgs.width-739/300},t.prototype.addEvent=function(){this.once(egret.Event.REMOVED_FROM_STAGE,this.onDistory,this),this.btn_no.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn1Tap,this),this.btn_yes.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn1Tap,this),this.btn_no2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn2Tap,this),this.btn_yes2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn2Tap,this)},t.prototype.onDistory=function(){this.btn_no.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn1Tap,this),this.btn_yes.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn1Tap,this),this.btn_no2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn2Tap,this),this.btn_yes2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtn2Tap,this)},t.prototype.childrenCreateder=function(e,t){if(this.g_step1.visible=!1,this.g_step2.visible=!0,0!=t){var i=egret.getTimer()-t;this.pgsTimer=new egret.Timer(100,Math.floor(300-i/100)),this.img_pgs.width=739-i/100*739/300}else this.pgsTimer=new egret.Timer(100,300);this.pgsTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.pgsTimer.start(),NetData.addEvt(NetData.CODE_Game_isvalidation,this.GameIsva,this);for(var n=0;4>n;n++)this["img_head"+(n+1)].source=e[0][n].headImgUrl,this["txt_name"+(n+1)].text=e[0][n].nickname,1==e[0][n].status&&(this["img_status"+(n+1)].visible=!0)},t.prototype.GameIsva=function(e){for(var t=0;4>t;t++)if(this["txt_name"+(t+1)].text==e.data[0].nickname){1==e.data[0].status&&(this["img_status"+(t+1)].visible=!0);break}},t.prototype.onBtn1Tap=function(e){switch(e.currentTarget){case this.btn_no:this.dispatchEvent(new egret.Event(EventName.BTN_CHOOSE_PRE)),this.parent.removeChild(this);break;case this.btn_yes:this.dispatchEvent(new egret.Event(EventName.BTN_CHOOSE_NEXT)),this.parent.removeChild(this)
}},t.prototype.onBtn2Tap=function(e){switch(e.currentTarget){case this.btn_no2:break;case this.btn_yes2:}},t}(eui.Component);__reflect(AlertValidation.prototype,"AlertValidation");var FaceAct=function(e){function t(t){var i=e.call(this)||this;return i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onInit,i),i.type=t.substr(0,t.length-4),i}return __extends(t,e),t.prototype.onInit=function(){if(null==Global.faceFactory){var e=RES.getRes("faceGif_json"),t=RES.getRes("faceGif_png");Global.faceFactory=new egret.MovieClipDataFactory(e,t)}var i=new egret.MovieClip(Global.faceFactory.generateMovieClipData(this.type));this.addChild(i),i.frameRate=5,i.gotoAndPlay(0,-1),egret.setTimeout(this.onRemoveStage,this,2e3)},t.prototype.onRemoveStage=function(){this&&this.parent&&this.parent.removeChild(this)},t}(eui.Group);__reflect(FaceAct.prototype,"FaceAct");var HallUserPage=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/HallUserSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.img_head.mask=this.headMask,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.onClick=function(e){"add"==e.target.name?this.onTouchAdd():this.dispatchEventWith(EventName.CREATE_PAGE_USERINFO,!0)},t.prototype.onTouchAdd=function(){this.dispatchEventWith(EventName.CREATE_PAGE_SHOP,!0)},Object.defineProperty(t.prototype,"SetHeadImg",{get:function(){return this._SetHeadImg},set:function(e){this._SetHeadImg=e,this.img_head.source=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SetNickName",{get:function(){return this._SetNickName},set:function(e){this._SetNickName=e,this.lb_nickname.text=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SetId",{get:function(){return this._SetId},set:function(e){this._SetId=e,this.lb_id.text="ID:"+e.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SetMoney",{get:function(){return this._SetMoney},set:function(e){this._SetMoney=e,this.lb_money.text=e.toString(),t.PlayerScore=this.lb_money.text},enumerable:!0,configurable:!0}),t.PlayerScore="0",t}(eui.Component);__reflect(HallUserPage.prototype,"HallUserPage");var TablePage=function(e){function t(t){void 0===t&&(t=!1);var i=e.call(this)||this;return i.isduanxiancome=!1,i.playerList={},i.topBarTimer=new egret.Timer(50,0),i.obj=i,i.skinName="resource/skins/TableSkin.exml",i.isduanxiancome=t,i}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.init(this.isduanxiancome),this.initUIListener(),this.initSocketListener(),this.c_btnHover.setType(1),IframeManager.getInstance().initWxShare("{platform}-扣点麻将，房间号为"+Room.NUMBER,"场次："+(1==Room.RULE.roomType_1?"普通场":"风耗子场")+" 局数："+Room.ALL_TIMES+"局 胡牌类型："+(0==Room.RULE.roomType_2?"":1==Room.RULE.roomType_2?"清一色、一条龙、豪华大七对":2==Room.RULE.roomType_2?"十三幺":"清一色、一条龙、豪华大七对，十三幺")+" 扣费方式："+(1==Room.RULE.roomType_5?"房主付费":"AA制"),"")},t.prototype.Maycheater=function(e){if(null!=e.data){2==e.data[0].mayCheat[0].length?(this.g_gao.visible=!0,this.lb_game_gao.textFlow=[{text:"玩家"},{text:FishUtil.limitNick(e.data[0].mayCheat[0][0]),style:{fontFamily:"黑体",size:28,textColor:16777215}},{text:"和"},{text:FishUtil.limitNick(e.data[0].mayCheat[0][1]),style:{fontFamily:"黑体",size:28,textColor:16777215}},{text:"是同一个IP"}]):3==e.data[0].mayCheat[0].length&&(this.g_gao.visible=!0,this.lb_game_gao.textFlow=[{text:"玩家"},{text:FishUtil.limitNick(e.data[0].mayCheat[0][0])+",",style:{fontFamily:"黑体",size:28,textColor:16777215}},{text:FishUtil.limitNick(e.data[0].mayCheat[0][1]),style:{fontFamily:"黑体",size:28,textColor:16777215}},{text:"和"},{text:FishUtil.limitNick(e.data[0].mayCheat[0][2]),style:{fontFamily:"黑体",size:28,textColor:16777215}},{text:"是同一个IP"}]);var t=new egret.Timer(3e3,1);t.addEventListener(egret.TimerEvent.TIMER,this.onTimeshow,this),t.start()}},t.prototype.onTimeshow=function(){1==this.g_gao.visible&&(this.g_gao.visible=!1)},t.prototype.IshowBt=function(){Global.isGameStart?this.g_other.visible=!1:this.g_other.visible=!0},t.prototype.init=function(e){var t=this;this._Share.left=this._Share.right=this._Share.top=this._Share.bottom=0,this._Share.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t._Share.visible=!1,t._Share.touchEnabled=!1},this),this._Share.visible=!1;var i=function(e){e.size=28,e.fontFamily="黑体",e.textColor=5817765};if(this.g_topBar.removeChildren(),null!=Room.NUMBER){var n=new eui.Label("房间号："+Room.NUMBER);i(n),this.g_topBar.addChild(n)}if(null!=Room.RULE.roomType_1){var n=new eui.Label("场次："+(1==Room.RULE.roomType_1?"普通场":"风耗子场"));i(n),this.g_topBar.addChild(n)}if(Room.RULE.roomType_2){var o="和牌类型：";switch(Room.RULE.roomType_2){case 1:o+="清一色、一条龙、豪华大七对";break;case 2:o+="十三幺";break;case 7:o+="清一色、一条龙、豪华大七对，十三幺"}var n=new eui.Label(o);i(n),this.g_topBar.addChild(n)}if(null!=Room.ALL_TIMES&&null!=Room.TIMES){var n=new eui.Label("局数："+(Room.ALL_TIMES-Room.TIMES)+"/"+Room.ALL_TIMES);i(n),this.g_topBar.addChild(n)}if(null!=Room.RULE.roomType_4){var n=new eui.Label("玩法：首张随庄");i(n),this.g_topBar.addChild(n)}if(null!=Room.RULE.roomType_5){var n=new eui.Label("付费模式："+(1==Room.RULE.roomType_5?"房主付费":"AA制付费"));i(n),this.g_topBar.addChild(n)}if(this.topBarTimer.addEventListener(egret.TimerEvent.TIMER,function(){t.g_topBar.x-=3,t.g_topBar.x+t.g_topBar.width<290&&(t.g_topBar.x=916)},this),this.topBarTimer.start(),this.player_left.IsHead=!1,this.player_right.IsHead=!1,this.player_top.IsHead=!1,this.player_bottom.IsHead=!1,this.btn_table_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_Share,this),this.isduanxiancome){var a=new Array;a.push(Global.mainScene.playersdate.data),Global.mainScene.playersdate.data=a,this.onRoomInfoUpdata(Global.mainScene.playersdate)}},t.prototype.initUIListener=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_set.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSet,this),this.btn_message.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTalk,this),this.c_btnHover.addEventListener(HoverEvent.CLICK_ITEM,this.onClick_Hover,this),this.player_bottom.addEventListener(EventName.BTN_SITDOWN,this.onSitDown,this),this.player_right.addEventListener(EventName.BTN_SITDOWN,this.onSitDown,this),this.player_top.addEventListener(EventName.BTN_SITDOWN,this.onSitDown,this),this.player_left.addEventListener(EventName.BTN_SITDOWN,this.onSitDown,this)},t.prototype.initSocketListener=function(){NetData.addEvt(NetData.CODE_JOIN_ROOM_SUCCESS,this.onRoomInfoUpdata,this),NetData.addEvt(NetData.CODE_UPDATA_ROOM,this.onRoomInfoUpdata,this),NetData.addEvt(NetData.CODE_SIT_DOWN,this.onSitDownData,this),NetData.addEvt(NetData.CODE_OTHER_SIT_DOWN,this.onOtherSitDownData,this),NetData.addEvt(NetData.CODE_STAND_UP,this.onStandUpData,this),NetData.addEvt(NetData.CODE_BREAK_ROOM,this.onGetExitRoom,this),NetData.addEvt(NetData.CODE_GAME_START,this.onGameStart,this),NetData.addEvt(NetData.CODE_GAME_OffLineImg,this.OnOffLineImg,this),NetData.addEvt(NetData.CODE_GAME_OnLineImg,this.OnOnLineImg,this),NetData.addEvt(NetData.CODE_Game_mayCheat,this.Maycheater,this),NetData.addEvt(NetData.CODE_PLAYER_CHAT,this.onGetFace,this)},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_set.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSet,this),this.btn_table_hall.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_BackToHall,this),this.btn_table_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_Share,this),this.btn_table_exit.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_Exit,this),this.player_bottom.removeEventListener(EventName.BTN_SITDOWN,this.onSitDown,this),this.player_right.removeEventListener(EventName.BTN_SITDOWN,this.onSitDown,this),this.player_top.removeEventListener(EventName.BTN_SITDOWN,this.onSitDown,this),this.player_left.removeEventListener(EventName.BTN_SITDOWN,this.onSitDown,this),this.btn_message.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTalk,this),this.c_btnHover.removeEventListener(HoverEvent.CLICK_ITEM,this.onClick_Hover,this),this.dispatchEvent(new egret.Event(EventName.REMOVE_TABLE)),NetData.removeEvt(NetData.CODE_JOIN_ROOM_SUCCESS,this.onRoomInfoUpdata,this),NetData.removeEvt(NetData.CODE_UPDATA_ROOM,this.onRoomInfoUpdata,this),NetData.removeEvt(NetData.CODE_BREAK_ROOM,this.onGetExitRoom,this),NetData.removeEvt(NetData.CODE_GAME_START,this.onGameStart,this),NetData.removeEvt(NetData.CODE_GAME_OffLineImg,this.OnOffLineImg,this),NetData.removeEvt(NetData.CODE_GAME_OnLineImg,this.OnOnLineImg,this),NetData.removeEvt(NetData.CODE_SIT_DOWN,this.onSitDownData,this),NetData.removeEvt(NetData.CODE_OTHER_SIT_DOWN,this.onOtherSitDownData,this),NetData.removeEvt(NetData.CODE_STAND_UP,this.onStandUpData,this),NetData.removeEvt(NetData.CODE_PLAYER_CHAT,this.onGetFace,this),this.topBarTimer&&this.topBarTimer.running&&this.topBarTimer.stop()},t.prototype.onSet=function(){console.log("设置"),this.dispatchEventWith(EventName.CREATE_PAGE_SET,!0)},t.prototype.onClick_Back=function(){var e={cmd:NetData.CODE_BACK_BY_EXIT,msg:[{roomId:Room.NUMBER}]};NetData.addEvt(NetData.CODE_BACK_BY_EXIT,this.onExitRoom,this),SocketUtil.getInstance().onSendMessage(e)},t.prototype.onClick_BackToHall=function(){var e={cmd:NetData.CODE_BACK_BY_EXIT,msg:[{roomId:Room.NUMBER}]};NetData.addEvt(NetData.CODE_BACK_BY_EXIT,this.onExitRoom,this),SocketUtil.getInstance().onSendMessage(e)},t.prototype.onClick_Share=function(){this.c_btnHover.showShare(1)},t.prototype.onClick_Exit=function(){function e(){n.onClick_BreakRoom()}function t(){console.log("取消解散")}var i=new AlertValidation(1,!0);this.addChild(i),i.once(EventName.BTN_CHOOSE_PRE,t,this),i.once(EventName.BTN_CHOOSE_NEXT,e,this);var n=this},t.prototype.onSitDown=function(e){var t=0;switch(e.currentTarget){case this.player_bottom:t=1;break;case this.player_right:t=2;break;case this.player_top:t=3;break;case this.player_left:t=4}if(0!=t){var i={cmd:NetData.CODE_SIT_DOWN,msg:[{roomId:Room.NUMBER,index:t}]};SocketUtil.getInstance().onSendMessage(i)}},t.prototype.onSitDownData=function(e){var t=e.data[0];Player.SeatNumber=t.index,Player.NickName=t.nickname,Player.HeadImg=t.headImgUrl,Player.PlayerScore=t.score,this.playerList[t.index]=t,this.player_bottom.recordIndex=t.index,this.player_bottom.IsHead=!0,this.player_bottom.SetNickName=FishUtil.limitNick(t.nickname),this.player_bottom.SetMoney=t.score,this.player_bottom.SetHeadImg=t.headImgUrl,this.initSeatNo(t)},t.prototype.onOtherSitDownData=function(e){var t=e.data[0];this.playerList[t.index]=t,0==Player.SeatNumber||null==Player.SeatNumber?(this["player_"+Player.onPSeat(t.index)].recordIndex=t.index,this["player_"+Player.onPSeat(t.index)].IsHead=!0,this["player_"+Player.onPSeat(t.index)].SetNickName=FishUtil.limitNick(t.nickname),this["player_"+Player.onPSeat(t.index)].SetMoney=t.score,this["player_"+Player.onPSeat(t.index)].SetHeadImg=t.headImgUrl):(this["player_"+Player.onSeat(t.index)].recordIndex=t.index,this["player_"+Player.onSeat(t.index)].IsHead=!0,this["player_"+Player.onSeat(t.index)].SetNickName=FishUtil.limitNick(t.nickname),this["player_"+Player.onSeat(t.index)].SetMoney=t.score,this["player_"+Player.onSeat(t.index)].SetHeadImg=t.headImgUrl),this.c_playerAni.setPlayer(t)},t.prototype.initSeatNo=function(e){if(1!=Player.SeatNumber){this.g_player.visible=!1,this.c_playerAni.visible=!0,this.c_playerAni.setPlayer(e,!0,this.playerSeatSuccess,this),this.onResetRoomPlayer();for(var t in this.playerList)this["player_"+Player.onSeat(parseInt(t))].recordIndex=this.playerList[t].index,this["player_"+Player.onSeat(parseInt(t))].IsHead=!0,this["player_"+Player.onSeat(parseInt(t))].SetNickName=FishUtil.limitNick(this.playerList[t].nickname),this["player_"+Player.onSeat(parseInt(t))].SetMoney=this.playerList[t].score,this["player_"+Player.onSeat(parseInt(t))].SetHeadImg=this.playerList[t].headImgUrl}},t.prototype.playerSeatSuccess=function(){this.obj.g_player.visible=!0},t.prototype.onStandUp=function(){var e={cmd:NetData.CODE_STAND_UP,msg:[{roomId:Room.NUMBER}]};SocketUtil.getInstance().onSendMessage(e)},t.prototype.onStandUpData=function(e){var t=e.data;if(null==t){this.player_bottom.IsHead=!1,this.c_playerAni.clearPlayer(Player.SeatNumber),delete this.playerList[Player.SeatNumber],Player.SeatNumber=0,this.onResetRoomPlayer();for(var i in this.playerList)this["player_"+Player.onPSeat(parseInt(i))].recordIndex=this.playerList[i].index,this["player_"+Player.onPSeat(parseInt(i))].IsHead=!0,this["player_"+Player.onPSeat(parseInt(i))].SetNickName=FishUtil.limitNick(this.playerList[i].nickname),this["player_"+Player.onPSeat(parseInt(i))].SetMoney=this.playerList[i].score,this["player_"+Player.onPSeat(parseInt(i))].SetHeadImg=this.playerList[i].headImgUrl}else for(var i in this.playerList)if(this.playerList[i].roleId==t[0].roleId){0==Player.SeatNumber||null==Player.SeatNumber?this["player_"+Player.onPSeat(this.playerList[i].index)].IsHead=!1:this["player_"+Player.onSeat(this.playerList[i].index)].IsHead=!1,this.c_playerAni.clearPlayer(this.playerList[i].index),delete this.playerList[this.playerList[i].index];break}},t.prototype.onExitRoom=function(){console.log("退出房间"),IframeManager.getInstance().backToHall()},t.prototype.onClick_BreakRoom=function(){console.log("解散房间");var e={cmd:NetData.CODE_BREAK_ROOM,msg:[{roomId:Room.NUMBER}]};SocketUtil.getInstance().onSendMessage(e),Player.isRoomCreated=!1},t.prototype.onClick_Hover=function(e){switch(console.log("点击HOVER"),e.data){case 3:this.addChild(new Page_How);break;case 5:Player.isMaster?this.onClick_BreakRoom():this.onClick_Back()}},t.prototype.onTalk=function(){console.log("文字"),this.dispatchEventWith(EventName.CREATE_PAGE_TALK,!0)},t.prototype.onGetFace=function(e){if("expression"==e.data[0].message.substr(0,10)){var t=new FaceAct(e.data[0].message);switch(console.log("face="+Global.playerFace),this["g_"+Player.onSeat(e.data[0].index)+"_act"].addChild(t),Player.onSeat(e.data[0].index)){case"top":t.x=-82,t.y=-181;break;case"bottom":t.x=-81,t.y=93;break;case"left":t.x=-136,t.y=-82;break;case"right":t.x=215,t.y=-81}}else{var i=new TalkPage(e.data[0].message,Player.onSeat(e.data[0].index),!1);-1!=Global.CheckTalk(e.data[0].message)&&(1==e.data[0].sex?Sound.getInstance().playerEffc("man_chat"+Global.CheckTalk(e.data[0].message)):Sound.getInstance().playerEffc("woman_chat"+Global.CheckTalk(e.data[0].message))),this["g_"+Player.onSeat(e.data[0].index)+"_act"].addChild(i),egret.Tween.get(i).wait(1500).to({alpha:0},1e3).call(i.onRemoveStage)}},t.prototype.onRoomInfoUpdata=function(e){if(this.onResetRoomPlayer(),this.checkMeSeatNo(e.data[0]),this.c_playerAni.initPlayer(),Room.RoomPlayerInfo=e.data[0],null!=Room.RoomPlayerInfo){this.playerList=new Object;for(var t=0;t<Room.RoomPlayerInfo.length;t++)null!=Room.RoomPlayerInfo[t]&&(this.playerList[Room.RoomPlayerInfo[t].index]=Room.RoomPlayerInfo[t],this.c_playerAni.setPlayer(Room.RoomPlayerInfo[t]),0==Player.SeatNumber||null==Player.SeatNumber?(this["player_"+Player.onPSeat(Room.RoomPlayerInfo[t].index)].recordIndex=Room.RoomPlayerInfo[t].index,this["player_"+Player.onPSeat(Room.RoomPlayerInfo[t].index)].IsHead=!0,this["player_"+Player.onPSeat(Room.RoomPlayerInfo[t].index)].SetNickName=FishUtil.limitNick(Room.RoomPlayerInfo[t].nickname),this["player_"+Player.onPSeat(Room.RoomPlayerInfo[t].index)].SetMoney=Room.RoomPlayerInfo[t].score,this["player_"+Player.onPSeat(Room.RoomPlayerInfo[t].index)].SetHeadImg=Room.RoomPlayerInfo[t].headImgUrl):(this["player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].recordIndex=Room.RoomPlayerInfo[t].index,this["player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].IsHead=!0,this["player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].SetNickName=FishUtil.limitNick(Room.RoomPlayerInfo[t].nickname),this["player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].SetMoney=Room.RoomPlayerInfo[t].score,this["player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].SetHeadImg=Room.RoomPlayerInfo[t].headImgUrl))}},t.prototype.checkMeSeatNo=function(e){for(var t=0;t<e.length;t++)if(null!=e[t]&&e[t].roleId==Player.USERINFO.roleId){Player.SeatNumber=e[t].index;break}},t.prototype.OnOffLineImg=function(e){this["player_"+Player.onSeat(e.data[0].index)].OffLine.visible=!0},t.prototype.ShowVoice=function(e){this["player_"+Player.onSeat(e)].ShowVoice.visible=!0,this["player_"+Player.onSeat(e)].onRecording()},t.prototype.HideVoice=function(){this.player_top.ShowVoice.visible=!1,this.player_bottom.ShowVoice.visible=!1,this.player_right.ShowVoice.visible=!1,this.player_left.ShowVoice.visible=!1,this.player_top.onRecordEnd(),this.player_bottom.onRecordEnd(),this.player_right.onRecordEnd(),this.player_left.onRecordEnd()},t.prototype.OnOnLineImg=function(e){this["player_"+Player.onSeat(e.data[0].index)].OffLine.visible=!1},t.prototype.onResetRoomPlayer=function(){this.player_top.IsHead=!1,this.player_right.IsHead=!1,this.player_left.IsHead=!1,this.player_bottom.IsHead=!1},t.prototype.onGetExitRoom=function(e){if(1==e.data[0].type){var t=new AlertPage("本房间超过10分钟还未开始游戏，已被自动解散");this.addChild(t),t.once(egret.Event.REMOVED_FROM_STAGE,this.onExitRoom,this)}else if(Player.isMaster)this.onExitRoom();else{var i=new AlertPage("房主解散房间，返回大厅");this.addChild(i),i.once(egret.Event.REMOVED_FROM_STAGE,this.onExitRoom,this)}Global.isGameStart=!1,Player.PlayerScore="0",console.log("看这里：退出时候"+Global.isGameStart)},t.prototype.onGameStart=function(e){console.log(""),Room.RoomPlayerInfo=new Array;for(var t in this.playerList)Room.RoomPlayerInfo.push(this.playerList[t]);Player.HandCard=e.data[0].cards,Global.mainScene.onCreateGame()},t}(eui.Component);__reflect(TablePage.prototype,"TablePage");var TalkPage=function(e){function t(t,i,n){void 0===n&&(n=!0);var o=e.call(this)||this;return o.skinName="resource/skins/TalkSkin.exml",o.content=t,o.seat=i,o.onGamePage=n,o}return __extends(t,e),t.prototype.childrenCreated=function(){if(this.lb_content.text=this.content,this.onGamePage)switch(this.seat){case"bottom":this.img_talk1.visible=!0;break;case"right":this.img_talk2.visible=!0;break;case"top":this.img_talk3.visible=!0;break;case"left":this.img_talk3.visible=!0}else switch(this.seat){case"bottom":this.img_talk1.visible=!0;break;case"right":this.img_talk3.visible=!0,this.img_talk3.x=244,this.img_talk3.scaleX=-1;break;case"top":this.img_talk3.visible=!0;break;case"left":this.img_talk3.visible=!0}},t.prototype.onRemoveStage=function(){this&&this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(TalkPage.prototype,"TalkPage");var Card=function(e){function t(t){var i=e.call(this)||this;return i.isSelected=!1,i.type=t,i.init(),i}return __extends(t,e),t.prototype.init=function(){if(this.card=new eui.Image,this.addChild(this.card),this.type==Statics.CARD_TYPE_LEFT||this.type==Statics.CARD_TYPE_RIGHT||this.type==Statics.CARD_TYPE_TOP){var e=void 0;this.type==Statics.CARD_TYPE_LEFT?e="card_hide_left":this.type==Statics.CARD_TYPE_RIGHT?e="card_hide_right":this.type==Statics.CARD_TYPE_TOP&&(e="card_hide_top"),this.card.source=RES.getRes(e+"_png")}if(this.type==Statics.CARD_TYPE_HIDE_TOP||this.type==Statics.CARD_TYPE_HIDE_LEFT||this.type==Statics.CARD_TYPE_HIDE_RIGHT){var e=void 0;this.type==Statics.CARD_TYPE_HIDE_TOP?e="card_hide_bottom":(this.type==Statics.CARD_TYPE_HIDE_LEFT||this.type==Statics.CARD_TYPE_HIDE_RIGHT)&&(e="card_hide_back"),this.card.source=RES.getRes(e+"_png")}},Object.defineProperty(t.prototype,"SetFaceNumber",{get:function(){return this._SetFaceNumber},set:function(e){this._SetFaceNumber=e;var t;if(this.type==Statics.CARD_TYPE_SELF)t="card_self";else if(this.type==Statics.CARD_TYPE_SHOW_BOTTOM)t="card_show_bottom";else if(this.type==Statics.CARD_TYPE_SHOW_TOP)t="card_show_top";else if(this.type==Statics.CARD_TYPE_SHOW_LEFT)t="card_show_left";else if(this.type==Statics.CARD_TYPE_SHOW_RIGHT)t="card_show_right";else{if(this.type!=Statics.CARD_TYPE_SHOW_SELF)return void console.log("牌的类型错误");t="card_show_self"}this.card.source=RES.getRes(t+e+"_png")},enumerable:!0,configurable:!0}),t.prototype.setFeng=function(){var e=new eui.Image;e.source=RES.getRes("feng_png"),e.x=52,e.y=25,this.addChild(e)},t.prototype.setTing=function(){var e=new eui.Rect(this.width,this.height-2,0);e.ellipseWidth=11,e.ellipseHeight=11,e.fillAlpha=.5,e.x=e.y=0,e.touchEnabled=!1,this.addChild(e)},t}(eui.Component);__reflect(Card.prototype,"Card");var CardBox=function(e){function t(){var t=e.call(this)||this;return t.gangs=[],t.padding=20,t.isSendInfo=!1,t.skinName="resource/skins/card/CardBoxSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){var e=this;this.g_list.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_List,this),this.CloseBt.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.BoxCloseFun&&e.BoxCloseFun(),e.parent.contains(e)&&e.parent.removeChild(e)},this)},t.prototype.onAddGang=function(e){for(var t=0;t<e.length;t++){var i=new Card(Statics.CARD_TYPE_SHOW_BOTTOM);i.SetFaceNumber=e[t],this.g_list.addChild(i),i.x=i.width*t+this.padding*t,i.name="Gang"+e[t]}},t.prototype.onAddCard=function(e){3==e.length?this.g_list.layout.gap=64:4==e.length?this.g_list.layout.gap=34:2==e.length?this.g_list.layout.gap=91:5==e.length&&(this.g_list.layout.gap=19);for(var t=0;t<e.length;t++){var i=new Card(Statics.CARD_TYPE_SHOW_BOTTOM);i.SetFaceNumber=e[t],this.g_list.addChild(i),i.name="CA"+e[t]}this.scaleX=this.scaleY=1.5},t.prototype.onClick_List=function(e){console.log("vt.target.parent.name.substr(0,4):"+e.target.parent.name.substr(0,4)),"Gang"==e.target.parent.name.substr(0,4)?(this.g_list.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_List,this),this.dispatchEventWith("Gang",!1,e.target.parent.name.substr(4,6))):"AG"==e.target.parent.name.substr(0,2)?console.log("暗杠"):"PE"==e.target.parent.name.substr(0,2)?console.log("碰"):"CA"==e.target.parent.name.substr(0,2)&&(console.log("牌"),this.g_list.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_List,this),this.isSendInfo||(this.isSendInfo=!0,this.dispatchEventWith("Ting",!1,e.target.parent.name.substr(2,4))))},t}(eui.Component);__reflect(CardBox.prototype,"CardBox");var CardGroupBottom=function(e){function t(){var t=e.call(this)||this;return t.cards=[],t.cardNums=[],t.isPut=!1,t.isTing=!1,t.UnActiveCardIndex=0,t.PengTypeAry=[],t.showCardWidth=71,t.dingCardSpace=230,t.cardHeight=27,t.skinName="resource/skins/card/CardGroupBottomSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.g_test.visible=!1},t.prototype.onGetCard=function(e){if(this.cardNums=e,0!=this.cards.length){for(var t=0;t<this.cards.length;t++)this.cards[t]&&this.cards[t].parent&&this.cards[t].parent.removeChild(this.cards[t]);this.cards=[]}for(var t=0;t<e.length;t++){var i=new Card(Statics.CARD_TYPE_SELF);i.x=1006-74*t,i.SetFaceNumber=e[e.length-t-1],e[e.length-t-1]==Room.FENG_CARD&&i.setFeng(),i.name="Card",this.cards.push(i),this.g_card.addChild(i),Player.ting?i.setTing():""}this.g_card.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_Card,this),this.isTing},t.prototype.onAddCard=function(e){var t=this;if(0==e)return void console.log("摸了一张 0 ");this._MOCard=e;var i=new Card(Statics.CARD_TYPE_SELF);e==Room.FENG_CARD&&i.setFeng(),i.x=1106,i.SetFaceNumber=e,i.name="Card",this.cardNums.push(e),this.cards.push(i),this.g_card.addChild(i);var n=egret.Tween.get(this);n.wait(1e3).call(function(){t.AuToOutCard()})},t.prototype.AuToOutCard=function(){if(this.parent._IsAuto&&this.isPut||this.parent.c_timeArrow.IsMyTimerOut&&this.isPut)if(1==this.parent.c_player_PGH.visible);else{var e={cmd:NetData.CODE_GAME_PUT_CARD,msg:[{roomId:Room.NUMBER,playerId:Player.OPENID,card:this._MOCard,index:Player.SeatNumber}]};SocketUtil.getInstance().onSendMessage(e),this.cardNums.splice(this.cardNums.indexOf(this._MOCard),1),this.cardNums=FishUtil.InsertSort(this.cardNums),this.onGetCard(this.cardNums),this.parent.c_timeArrow.IsMyTimerOut=!1,this.isPut=!1}},t.prototype.RemoveHoldCard=function(e){this.cardNums.splice(this.cardNums.indexOf(parseInt(e)),1),this.cardNums=FishUtil.InsertSort(this.cardNums),this.onGetCard(this.cardNums)},t.prototype.OnPengCard=function(e,t){void 0===t&&(t="1"),this.PengTypeAry.push(e),"1"==t&&(this.cardNums.splice(this.cardNums.indexOf(parseInt(e)),1),this.cardNums.splice(this.cardNums.indexOf(parseInt(e)),1),this.onGetCard(this.cardNums));for(var i=0;3>i;i++){var n=new Card(Statics.CARD_TYPE_SHOW_SELF);n.SetFaceNumber=parseInt(e),n.x=i*this.showCardWidth+this.UnActiveCardIndex*this.dingCardSpace,this.UnActiveGroup.addChildAt(n,0),Player.ting&&n.setTing()}this.UnActiveCardIndex++,this._MOCard=this.cardNums[0],this.isPut=!0},t.prototype.OnGangCard=function(e,t){var i=0;i=0==t?3:1==t?4:2==t?1:0;for(var n=0;i>n;n++)this.cardNums.splice(this.cardNums.indexOf(e),1);this.onGetCard(this.cardNums);var o=this.PengTypeAry.indexOf(e);if(o>=0){var a=new Card(Statics.CARD_TYPE_SHOW_SELF);a.SetFaceNumber=parseInt(e),a.x=this.showCardWidth+o*this.dingCardSpace,a.y=-this.cardHeight,this.UnActiveGroup.addChild(a),Player.ting&&a.setTing()}else{for(var n=0;4>n;n++){var a=new Card(Statics.CARD_TYPE_SHOW_SELF);a.SetFaceNumber=parseInt(e),3==n?(a.x=this.showCardWidth+this.UnActiveCardIndex*this.dingCardSpace,a.y=-this.cardHeight,1==this.parent.isangang?(a.card.source=RES.getRes("card_hide_self_png"),this.UnActiveGroup.addChild(a)):this.UnActiveGroup.addChild(a)):(a.x=n*this.showCardWidth+this.UnActiveCardIndex*this.dingCardSpace,this.UnActiveGroup.addChildAt(a,0)),Player.ting&&a.setTing()}this.UnActiveCardIndex++}},t.prototype.onResetCard=function(){for(var e=0;e<this.cards.length;e++)this.cards[e].y=0,this.cards[e].isSelected=!1},t.prototype.onClick_Card=function(e){if(e.target.parent instanceof Card)if(Sound.getInstance().playerEffc("selected_card"),e.target.parent.isSelected){if(e.target.parent.isSelected)if(!this.isPut||this.parent._IsAuto||this.parent.IsPlyaerOP)this.onResetCard();else{this.isPut=!1;var t={cmd:NetData.CODE_GAME_PUT_CARD,msg:[{roomId:Room.NUMBER,playerId:Player.OPENID,card:e.target.parent.SetFaceNumber,index:Player.SeatNumber}]};SocketUtil.getInstance().onSendMessage(t);for(var i=0;i<this.cardNums.length;i++)if(this.cardNums[i]==e.target.parent.SetFaceNumber){for(var n=i;n<this.cardNums.length-1;n++)this.cardNums[n]=this.cardNums[n+1];return this.cardNums.pop(),this.cardNums=FishUtil.InsertSort(this.cardNums),void this.onGetCard(this.cardNums)}}}else this.onResetCard(),e.target.parent.y=-30,e.target.parent.isSelected=!0},t.prototype.onRemoveCard=function(e){for(var t=0;t<this.cardNums.length;t++)if(this.cardNums[t]==e){for(var i=t;i<this.cardNums.length-1;i++)this.cardNums[i]=this.cardNums[i+1];return this.cardNums.pop(),this.cardNums=FishUtil.InsertSort(this.cardNums),void this.onGetCard(this.cardNums)}},t.prototype.onGameSureTing=function(){console.log("bottom:onGameSureTing")},t.prototype.showFengCard=function(){for(var e=0;e<this.cards.length;e++)this.cards[e].SetFaceNumber==Room.FENG_CARD&&this.cards[e].setFeng()},t.prototype.showTingCard=function(){if(Player.ting){for(var e=0;e<this.cards.length;e++)this.cards[e].setTing();for(var e=0;e<this.UnActiveGroup.numChildren;e++)this.UnActiveGroup.getChildAt(e).setTing()}},t.prototype.OffOnLineCome=function(e,t,i,n,o){this.onGetCard(e);for(var a=0;a<i.length;a++)this.OnPengCard(i[a],"2");for(var a=0;a<n.length;a++)this.OnGangCard(n[a],-1);this.onAddCard(o)},t}(eui.Component);__reflect(CardGroupBottom.prototype,"CardGroupBottom");var CardGroupLeft=function(e){function t(){var t=e.call(this)||this;return t.cards=[],t._handCard=[],t.UnActiveCardIndex=0,t.PengTypeAry=[],t.skinName="resource/skins/card/CardGroupLeftSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){for(var e=0;13>e;e++){var t=new Card(Statics.CARD_TYPE_LEFT);t.y=35*e,this.cards.push(t),this.g_card.addChild(t)}},t.prototype.onSetCardNumber=function(e){for(var t=0;t<this.cards.length;t++)this.cards[t]&&this.cards[t].parent&&this.cards[t].parent.removeChild(this.cards[t]),this.cards=[];for(var t=0;e>t;t++){var i=new Card(Statics.CARD_TYPE_LEFT);i.y=35*t,14==t&&(i.y=35*t+10),this.cards.push(i),this.g_card.addChild(i)}},t.prototype.OnPengCard=function(e,t){void 0===t&&(t="1"),this.PengTypeAry.push(e),"1"==t&&(this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)),this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)),this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)));for(var i=0;3>i;i++){var n=new Card(Statics.CARD_TYPE_SHOW_LEFT);n.SetFaceNumber=parseInt(e),n.y=32*i+130*this.UnActiveCardIndex,this.UnActiveGroup.addChildAt(n,i)}this.UnActiveCardIndex++},t.prototype.onGetCard=function(e){for(var t=0;t<this.cards.length;t++)this.cards[t]&&this.cards[t].parent&&this.cards[t].parent.removeChild(this.cards[t]),this.cards=[];this._handCard=e;for(var t=0;t<e.length;t++){var i=new Card(Statics.CARD_TYPE_LEFT);i.y=35*t,14==t&&(i.y=35*t+10),i.SetFaceNumber=e[t],this.cards.push(i),this.g_card.addChild(i)}},t.prototype.OnGangCard=function(e,t){var i=0;i=0==t?3:1==t?4:2==t?1:0;for(var n=0;i>n;n++)this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1));var o=this.PengTypeAry.indexOf(e);if(o>=0){var a=new Card(Statics.CARD_TYPE_SHOW_LEFT);a.SetFaceNumber=parseInt(e),a.y=15+130*o,this.UnActiveGroup.addChildAt(a,this.numChildren+1)}else{for(var n=0;4>n;n++){var a=new Card(Statics.CARD_TYPE_SHOW_LEFT);a.SetFaceNumber=parseInt(e),3==n?(a.y=15+130*this.UnActiveCardIndex,1==this.parent.isangang?(a.card.source=RES.getRes("card_hide_back_png"),this.UnActiveGroup.addChild(a)):this.UnActiveGroup.addChild(a)):(a.y=32*n+130*this.UnActiveCardIndex,this.UnActiveGroup.addChild(a))}this.UnActiveCardIndex++}},t.prototype.onGameSureTing=function(){console.log("left:onGameSureTing"),this.cards[0].card.texture=RES.getRes("card_hide_back_png")},t.prototype.OffOnLineCome=function(e,t,i,n,o){for(var a=0;13-t>a;a++)this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1));for(var r=0;r<i.length;r++)this.OnPengCard(i[r],"2");for(var s=0;s<n.length;s++)this.OnGangCard(n[s],-1)},t}(eui.Component);__reflect(CardGroupLeft.prototype,"CardGroupLeft");var CardGroupRight=function(e){function t(){var t=e.call(this)||this;return t.cards=[],t._handCard=[],t.UnActiveCardIndex=0,t.PengTypeAry=[],t.skinName="resource/skins/card/CardGroupRightSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){for(var e=0;13>e;e++){var t=new Card(Statics.CARD_TYPE_RIGHT);t.y=35*e,this.cards.push(t),this.g_card.addChild(t)}},t.prototype.OnPengCard=function(e,t){void 0===t&&(t="1"),this.PengTypeAry.push(e),"1"==t&&(this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)),this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)),this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)));for(var i=0;3>i;i++){var n=new Card(Statics.CARD_TYPE_SHOW_RIGHT);n.SetFaceNumber=parseInt(e),n.y=420-32*i-130*this.UnActiveCardIndex,this.UnActiveGroup.addChildAt(n,i),this.UnActiveGroup.setChildIndex(n,0)}this.UnActiveCardIndex++
},t.prototype.onGetCard=function(e){for(var t=0;t<this.cards.length;t++)this.cards[t]&&this.cards[t].parent&&this.cards[t].parent.removeChild(this.cards[t]),this.cards=[];this._handCard=e;for(var t=0;t<e.length;t++){var i=new Card(Statics.CARD_TYPE_LEFT);i.y=35*t,14==t&&(i.y=35*t+10),i.SetFaceNumber=e[t],this.cards.push(i),this.g_card.addChild(i)}},t.prototype.OnGangCard=function(e,t){var i=0;i=0==t?3:1==t?4:2==t?1:0;for(var n=0;i>n;n++)this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1));var o=this.PengTypeAry.indexOf(e);if(o>=0){var a=new Card(Statics.CARD_TYPE_SHOW_RIGHT);a.SetFaceNumber=parseInt(e),a.y=371-130*o,this.UnActiveGroup.addChildAt(a,this.numChildren+1)}else{for(var n=0;4>n;n++){var a=new Card(Statics.CARD_TYPE_SHOW_RIGHT);a.SetFaceNumber=parseInt(e),3==n?(a.y=371-130*this.UnActiveCardIndex,1==this.parent.isangang?(a.card.source=RES.getRes("card_hide_back_png"),this.UnActiveGroup.addChild(a)):this.UnActiveGroup.addChild(a)):(a.y=420-32*n-130*this.UnActiveCardIndex,this.UnActiveGroup.addChildAt(a,0))}this.UnActiveCardIndex++}},t.prototype.onSetCardNumber=function(e){for(var t=0;t<this.cards.length;t++)this.cards[t]&&this.cards[t].parent&&this.cards[t].parent.removeChild(this.cards[t]),this.cards=[];for(var t=0;e>t;t++){var i=new Card(Statics.CARD_TYPE_RIGHT);i.y=35*t,14==t&&(i.y=35*t+10),this.cards.push(i),this.g_card.addChild(i)}},t.prototype.onGameSureTing=function(){console.log("right:onGameSureTing"),this.cards[0].card.texture=RES.getRes("card_hide_back_png")},t.prototype.OffOnLineCome=function(e,t,i,n,o){for(var a=0;13-t>a;a++)this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1));for(var r=0;r<i.length;r++)this.OnPengCard(i[r],"2");for(var s=0;s<n.length;s++)this.OnGangCard(n[s],-1)},t}(eui.Component);__reflect(CardGroupRight.prototype,"CardGroupRight");var CardGroupShowBotton=function(e){function t(){var t=e.call(this)||this;return t.cardIndex=0,t.cards=[],t.skinName="resource/skins/card/CardGroupShowBottomSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onAddCard=function(e,t){void 0===t&&(t=!1),this.parent.M_PlayersCurOutCard=null;var i=new Card(Statics.CARD_TYPE_SHOW_BOTTOM);this.parent.M_PlayersCurOutCard=i,i.SetFaceNumber=e,this.g_card.addChild(i),this.cards.push(i),this.cardIndex++,t&&(i.card.source=RES.getRes("card_hide_bottom_png"))},t.prototype.onAddHideCard=function(){var e=new Card(Statics.CARD_TYPE_HIDE_TOP);this.g_card.addChild(e),this.cards.push(e),this.cardIndex++},t.prototype.OffOnLineCome=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++)t-1==i?this.onAddCard(e[i],!0):this.onAddCard(e[i],!1)},t}(eui.Component);__reflect(CardGroupShowBotton.prototype,"CardGroupShowBotton");var CardGroupShowLeft=function(e){function t(){var t=e.call(this)||this;return t.cardIndex=0,t.cards=[],t.skinName="resource/skins/card/CardGroupShowLeftSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onAddCard=function(e,t){void 0===t&&(t=!1),this.parent.M_PlayersCurOutCard=null;var i=new Card(Statics.CARD_TYPE_SHOW_LEFT);this.parent.M_PlayersCurOutCard=i,i.SetFaceNumber=e,this.g_card.addChild(i),this.cards.push(i),this.cardIndex++,t&&(i.card.source=RES.getRes("card_hide_back_png"))},t.prototype.onAddHideCard=function(){var e=new Card(Statics.CARD_TYPE_HIDE_LEFT);this.g_card.addChild(e),this.cards.push(e),this.cardIndex++},t.prototype.OffOnLineCome=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++)t-1==i?this.onAddCard(e[i],!0):this.onAddCard(e[i],!1)},t}(eui.Component);__reflect(CardGroupShowLeft.prototype,"CardGroupShowLeft");var CardGroupShowRight=function(e){function t(){var t=e.call(this)||this;return t.cardIndex=0,t.cards=[],t.skinName="resource/skins/card/CardGroupShowRightSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){},t.prototype.onAddCard=function(e,t){void 0===t&&(t=!1),this.parent.M_PlayersCurOutCard=null;var i=new Card(Statics.CARD_TYPE_SHOW_RIGHT);this.parent.M_PlayersCurOutCard=i,i.SetFaceNumber=e,this.cardIndex<11?(i.x=0,i.y=390-34*(this.cardIndex+1)):this.cardIndex<22?(i.x=59,i.y=390-34*(this.cardIndex+1-11)):(i.x=118,i.y=390-34*(this.cardIndex+1-22)),this.g_card.addChildAt(i,0),this.cards.push(i),this.cardIndex++,t&&(i.card.source=RES.getRes("card_hide_back_png"))},t.prototype.onAddHideCard=function(){var e=new Card(Statics.CARD_TYPE_HIDE_RIGHT);this.g_card.addChild(e),this.cards.push(e),this.cardIndex++},t.prototype.OffOnLineCome=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++)t-1==i?this.onAddCard(e[i],!0):this.onAddCard(e[i],!1)},t}(eui.Component);__reflect(CardGroupShowRight.prototype,"CardGroupShowRight");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var CardGroupTop=function(e){function t(){var t=e.call(this)||this;return t.cards=[],t._handCard=[],t.UnActiveCardIndex=0,t.showCardWidth=45,t.PengTypeAry=[],t.cardHeight=17,t.skinName="resource/skins/card/CardGroupTopSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){for(var e=0;13>e;e++){var t=new Card(Statics.CARD_TYPE_TOP);t.x=36*e,this.cards.push(t),this.g_card.addChild(t)}},t.prototype.OnPengCard=function(e,t){void 0===t&&(t="1"),this.PengTypeAry.push(e),"1"==t&&(this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)),this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)),this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1)));for(var i=0;3>i;i++){var n=new Card(Statics.CARD_TYPE_SHOW_TOP);n.SetFaceNumber=parseInt(e),n.x=632-i*this.showCardWidth-150*this.UnActiveCardIndex,this.UnActiveGroup.addChildAt(n,0)}console.log("当前定牌数量 -- "+this.UnActiveCardIndex),this.UnActiveCardIndex++},t.prototype.onGetCard=function(e){for(var t=0;t<this.cards.length;t++)this.cards[t]&&this.cards[t].parent&&this.cards[t].parent.removeChild(this.cards[t]),this.cards=[];this._handCard=e;for(var t=0;t<e.length;t++){var i=new Card(Statics.CARD_TYPE_LEFT);i.y=35*t,14==t&&(i.y=35*t+10),i.SetFaceNumber=e[t],this.cards.push(i),this.g_card.addChild(i)}},t.prototype.OnGangCard=function(e,t){var i=0;i=0==t?3:1==t?4:2==t?1:0;for(var n=0;i>n;n++)this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1));var o=this.PengTypeAry.indexOf(e);if(o>=0){var a=new Card(Statics.CARD_TYPE_SHOW_TOP);a.SetFaceNumber=parseInt(e),a.x=632-1*this.showCardWidth-150*o,a.y=-this.cardHeight,this.UnActiveGroup.addChildAt(a,this.numChildren+1)}else{for(var n=0;4>n;n++){var a=new Card(Statics.CARD_TYPE_SHOW_TOP);a.SetFaceNumber=parseInt(e),3==n?(a.x=632-1*this.showCardWidth-150*this.UnActiveCardIndex,a.y=-this.cardHeight,1==this.parent.isangang?(a.card.source=RES.getRes("card_hide_bottom_png"),this.UnActiveGroup.addChildAt(a,this.numChildren+1)):this.UnActiveGroup.addChildAt(a,this.numChildren+1)):(a.x=632-n*this.showCardWidth-150*this.UnActiveCardIndex,this.UnActiveGroup.addChildAt(a,n))}this.UnActiveCardIndex++}},t.prototype.onGameSureTing=function(){console.log("top:onGameSureTing"),this.cards[0].card.texture=RES.getRes("card_hide_bottom_png")},t.prototype.OffOnLineCome=function(e,t,i,n,o){for(var a=0;13-t>a;a++)this.g_card.contains(this.cards[this.cards.length-1])&&(this.g_card.removeChild(this.cards[this.cards.length-1]),this.cards.splice(this.cards.length-1,1));for(var r=0;r<n.length;r++)this.OnGangCard(n[r],-1);for(var s=0;s<i.length;s++)this.OnPengCard(i[s],"2")},t}(eui.Component);__reflect(CardGroupTop.prototype,"CardGroupTop");var GameBigEndPage=function(e){function t(){var t=e.call(this)||this;return t.p1Width=0,t.meScore=0,t.skinName="resource/skins/game/GameBigEndSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.once(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_continue.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onContinue,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareFun,this),this.rect_sharebg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGShareTouch,this),IframeManager.getInstance().addEventListener(NetConstant.SHARE_SUCCESS,this.onGShareTouch,this),IframeManager.getInstance().addEventListener(NetConstant.SHARE_FAIL,this.onGShareTouch,this),IframeManager.getInstance().addEventListener(NetConstant.SHARE_CANCEL,this.onGShareTouch,this),Player.Money=Global.endBigInfo[0].nowRoomCard,this.meScore=Global.endBigInfo[0].score,this.txt_roomNum.text=Room.NUMBER+"";var e=new Array;Global.endBigInfo.sort(function(e,t){return e.score>=t.score?-1:1});for(var t=0,i=0;4>i;i++){var n=new Object;n.nick=FishUtil.limitNick(Global.endBigInfo[i].nickname),n.score=Global.endBigInfo[i].score,n.round=Global.endBigInfo[i].allTime,n.win=Global.endBigInfo[i].win,n.lose=Global.endBigInfo[i].lose,n.headUrl=Global.endBigInfo[i].headImgUrl,n.score>0&&(n.rank=++t),e.push(n)}this.list_data.dataProvider=new eui.ArrayCollection(e),this.list_data.itemRenderer=Item_GameBigEnd,Global.isGameStart=!1,this.initShare()},t.prototype.onRemoveStage=function(){this.btn_continue.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onContinue,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareFun,this),this.rect_sharebg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGShareTouch,this)},t.prototype.onContinue=function(){IframeManager.getInstance().backToHall()},t.prototype.onShareFun=function(){this.g_share.visible=!0,this.showArrow()},t.prototype.onGShareTouch=function(){this.g_share.visible=!1,this.stopArrow()},t.prototype.showArrow=function(){this.arrow.play(0),this.arrow.hasEventListener(egret.Event.COMPLETE)||this.arrow.addEventListener(egret.Event.COMPLETE,this.onReplay,this)},t.prototype.onReplay=function(){this.arrow.play(0)},t.prototype.stopArrow=function(){this.arrow.stop(),this.arrow.removeEventListener(egret.Event.COMPLETE,this.onReplay,this)},t.prototype.initShare=function(){var e=FishUtil.limitNick(Global.endBigInfo[0].nickname)+"："+Global.endBigInfo[0].score+"，"+FishUtil.limitNick(Global.endBigInfo[1].nickname)+"："+Global.endBigInfo[1].score+"，"+FishUtil.limitNick(Global.endBigInfo[2].nickname)+"："+Global.endBigInfo[2].score+"，"+FishUtil.limitNick(Global.endBigInfo[3].nickname)+"："+Global.endBigInfo[3].score+"，";IframeManager.getInstance().initWxShare("我在河东棋牌-扣点麻将"+(this.meScore<0?"输了"+-this.meScore:"赢了"+this.meScore)+"分，你想一起玩吗？",e,"")},t}(eui.Component);__reflect(GameBigEndPage.prototype,"GameBigEndPage");var Item_GameBigEnd=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/item/Item_GameBigEndSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.img_head.source=e.headUrl,e.score>=0?(this.txt_score.text="+"+e.score,this.txt_score.textColor=12708447,null!=e.rank&&(this.img_gold.visible=!0,this.img_gold.source="estmt_g"+e.rank+"_png")):this.txt_score.textColor=16746118},t}(eui.ItemRenderer);__reflect(Item_GameBigEnd.prototype,"Item_GameBigEnd");var GameBtnHoverPage=function(e){function t(){var t=e.call(this)||this;return t.isOpen=!1,t.skinName="resource/skins/game/GameBtnHover.exml",t}return __extends(t,e),t.prototype.setType=function(e){1==e&&(Player.isMaster?this.img_dissolve.source="menu_item2_png":this.img_dissolve.source="menu_item1_png")},t.prototype.childrenCreated=function(){this.touchEnabled=!1,this.once(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_hover.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHover,this),this.btn_2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.btn_3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.btn_4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.btn_5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.rect_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onHover,this),IframeManager.getInstance().addEventListener(NetConstant.SHARE_SUCCESS,this.onShareTap,this),IframeManager.getInstance().addEventListener(NetConstant.SHARE_FAIL,this.onShareTap,this),IframeManager.getInstance().addEventListener(NetConstant.SHARE_CANCEL,this.onShareTap,this)},t.prototype.onRemoveStage=function(){this.btn_hover.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHover,this),this.btn_2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.btn_3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.btn_4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.btn_5.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBtnTap,this),this.rect_bg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onHover,this)},t.prototype.onHover=function(){this.isOpen=!this.isOpen,this.isOpen?(this.rect_bg.visible=!0,this.touchEnabled=!0,this.g_hover.touchThrough=!1,this.g_hover.touchEnabled=!0,this.g_hover.touchChildren=!0,this.show.play(0)):(this.rect_bg.visible=!1,this.touchEnabled=!1,this.g_hover.touchThrough=!0,this.g_hover.touchEnabled=!1,this.g_hover.touchChildren=!1,this.hide.play(0))},t.prototype.onBtnTap=function(e){switch(e.currentTarget){case this.btn_2:this.showShare(1);break;case this.btn_3:this.dispatchEvent(new HoverEvent(HoverEvent.CLICK_ITEM,3));break;case this.btn_4:this.showShare(2);break;case this.btn_5:this.dispatchEvent(new HoverEvent(HoverEvent.CLICK_ITEM,5))}this.onHover()},t.prototype.showShare=function(e){switch(this.g_share.visible=!0,this["img_share"+e].visible=!0,e){case 1:break;case 2:}this.showArrow(),this.rect_sharebg.once(egret.TouchEvent.TOUCH_TAP,this.onShareTap,this)},t.prototype.onShareTap=function(e){this.g_share.visible=!1,this.img_share1.visible=!1,this.img_share2.visible=!1,this.stopArrow(),this.isOpen&&this.onHover()},t.prototype.showArrow=function(){this.arrow.play(0),this.arrow.hasEventListener(egret.Event.COMPLETE)||this.arrow.addEventListener(egret.Event.COMPLETE,this.onReplay,this)},t.prototype.onReplay=function(){this.arrow.play(0)},t.prototype.stopArrow=function(){this.arrow.stop(),this.arrow.removeEventListener(egret.Event.COMPLETE,this.onReplay,this)},t}(eui.Component);__reflect(GameBtnHoverPage.prototype,"GameBtnHoverPage");var HoverEvent=function(e){function t(t,i,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1);var a=e.call(this,t,n,o)||this;return a._data=i,a}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),t.CLICK_ITEM="clickItem",t}(egret.Event);__reflect(HoverEvent.prototype,"HoverEvent");var GameEndPage=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/game/GameEndSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,Room.FENG_CARD=-1,Player.ting=!1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_continue.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onContinue,this),Global.endInfo.sort(function(e,t){return e.socre>=t.socre?-1:1});for(var e=new Array,t=0,i=0;4>i;i++){var n=new GameEndItemPage(Global.endInfo[i].peng,Global.endInfo[i].gangm,Global.endInfo[i].ganga,Global.endInfo[i].card,Global.endInfo[i].huCard),o=new Object;o.score=Global.endInfo[i].socre,o.headUrl=Global.endInfo[i].headImgUrl,o.cardData=n,o.score>0&&(o.rank=++t),e.push(o)}this.list_data.dataProvider=new eui.ArrayCollection(e),this.list_data.itemRenderer=Item_GameEnd},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_continue.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onContinue,this)},t.prototype.onContinue=function(){Global.isGameStart=!0,Global.mainScene.onRemoveEnd(),Room.TIMES>1&&(Global.mainScene.onRemoveGame(),Global.mainScene.onCreateTable(),Global.mainScene.tablePage.IshowBt()),null!=Global.mainScene.tablePage&&Global.mainScene.tablePage.IshowBt();var e={cmd:NetData.CODE_GAME_CONTINUE,msg:[{roomId:Room.NUMBER,times:Room.TIMES}]};SocketUtil.getInstance().onSendMessage(e)},t}(eui.Component);__reflect(GameEndPage.prototype,"GameEndPage");var Item_GameEnd=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/item/Item_GameEndSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){var e=this.data;this.img_head.source=e.headUrl,this.g_data.addChild(e.cardData),e.score>=0?(this.txt_score.text="+"+e.score,this.txt_score.textColor=12708447,null!=e.rank&&(this.img_gold.visible=!0,this.img_gold.source="estmt_g"+e.rank+"_png")):this.txt_score.textColor=16746118},t}(eui.ItemRenderer);__reflect(Item_GameEnd.prototype,"Item_GameEnd");var GamePage=function(e){function t(t){void 0===t&&(t=84);var i=e.call(this)||this;return i._cardNum=84,i.startTime=0,i.topBarTimer=new egret.Timer(50,0),i._IsAuto=!1,i.tings=[],i.pengs=[],i.IsMoCard=!1,i._OutCardIndex=0,i.IsPlyaerOP=!1,i.num=0,i.GangEvent=new egret.Event(NetData.CODE_GAME_EVENT_GANG.toString()),i.TingEvent=new egret.Event(NetData.CODE_GAME_EVENT_GANG.toString()),i.IsReadyTing=!1,i.IsHuOp=!1,i._cardNum=t,i.skinName="resource/skins/game/GameSkin.exml",i}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.c_timeArrow.SetArrow=Statics.ARROW_TOP,this.c_timeArrow.SetTime=15,this.c_btnHover.setType(2),this.init(),this.initUIListener(),this.initSocketListener(),document.addEventListener("keydown",function(e){switch(e.keyCode){case 13:Global.mainScene.onCreateEnd(),document.removeEventListener("keydown",onkeydown)}})},t.prototype.c_onckBottom=function(){this.gamehalluserinfo=new Page_UserInfoer;for(var e=this.c_player_bottom.SetNickName,t=0;t<Room.RoomPlayerInfo.length;t++)e==Room.RoomPlayerInfo[t].nickname&&(this.gamehalluserinfo.childrenCreateder(Room.RoomPlayerInfo[t].nickname,Room.RoomPlayerInfo[t].id,Room.RoomPlayerInfo[t].headImgUrl,Room.RoomPlayerInfo[t].ip),this.addChild(this.gamehalluserinfo))},t.prototype.c_onckTop=function(){this.gamehalluserinfo=new Page_UserInfoer;for(var e=this.c_player_top.SetNickName,t=0;t<Room.RoomPlayerInfo.length;t++)e==Room.RoomPlayerInfo[t].nickname&&(this.gamehalluserinfo.childrenCreateder(Room.RoomPlayerInfo[t].nickname,Room.RoomPlayerInfo[t].id,Room.RoomPlayerInfo[t].headImgUrl,Room.RoomPlayerInfo[t].ip),this.addChild(this.gamehalluserinfo))},t.prototype.c_onckLeft=function(){this.gamehalluserinfo=new Page_UserInfoer;for(var e=this.c_player_left.SetNickName,t=0;t<Room.RoomPlayerInfo.length;t++)e==Room.RoomPlayerInfo[t].nickname&&(this.gamehalluserinfo.childrenCreateder(Room.RoomPlayerInfo[t].nickname,Room.RoomPlayerInfo[t].id,Room.RoomPlayerInfo[t].headImgUrl,Room.RoomPlayerInfo[t].ip),this.addChild(this.gamehalluserinfo))},t.prototype.c_onckRight=function(){this.gamehalluserinfo=new Page_UserInfoer;for(var e=this.c_player_right.SetNickName,t=0;t<Room.RoomPlayerInfo.length;t++)e==Room.RoomPlayerInfo[t].nickname&&(this.gamehalluserinfo.childrenCreateder(Room.RoomPlayerInfo[t].nickname,Room.RoomPlayerInfo[t].id,Room.RoomPlayerInfo[t].headImgUrl,Room.RoomPlayerInfo[t].ip),this.addChild(this.gamehalluserinfo))},t.prototype.init=function(){var e=this;Room.RoomPlayerInfo;if(null!=Room.RoomPlayerInfo)for(var t=0;t<Room.RoomPlayerInfo.length;t++)if(null!=Room.RoomPlayerInfo[t]){if(Room.RoomPlayerInfo[t].index==Player.SeatNumber)continue;this["c_player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].IsHead=!0,this["c_player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].SetNickName=FishUtil.limitNick(Room.RoomPlayerInfo[t].nickname),this["c_player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].SetMoney=Room.RoomPlayerInfo[t].score,this["c_player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].SetHeadImg=Room.RoomPlayerInfo[t].headImgUrl,Room.RoomPlayerInfo[t].ting?this["c_player_"+Player.onSeat(Room.RoomPlayerInfo[t].index)].showTing():""}this.c_player_bottom.IsHead=!0,this.c_player_bottom.SetNickName=FishUtil.limitNick(Player.NickName),this.c_player_bottom.SetHeadImg=Player.HeadImg,this.c_player_bottom.SetMoney=parseInt(Player.PlayerScore),this.showHead.play();var i=function(e){e.size=28,e.fontFamily="黑体",e.textColor=5817765};if(this.g_topBar.removeChildren(),null!=Room.NUMBER){var n=new eui.Label("房间号："+Room.NUMBER);i(n),this.g_topBar.addChild(n)}if(null!=Room.RULE.roomType_1){var n=new eui.Label("场次："+(1==Room.RULE.roomType_1?"普通场":"风耗子场"));i(n),this.g_topBar.addChild(n)}if(Room.RULE.roomType_2){var o="和牌类型：";switch(Room.RULE.roomType_2){case 1:o+="清一色、一条龙、豪华大七对";break;case 2:o+="十三幺";break;case 7:o+="清一色、一条龙、豪华大七对，十三幺"}var n=new eui.Label(o);i(n),this.g_topBar.addChild(n)}if(null!=Room.ALL_TIMES&&null!=Room.TIMES){var n=new eui.Label("局数："+(Room.ALL_TIMES-Room.TIMES)+"/"+Room.ALL_TIMES);i(n),this.g_topBar.addChild(n)}if(null!=Room.RULE.roomType_4){var n=new eui.Label("玩法：首张随庄");i(n),this.g_topBar.addChild(n)}if(null!=Room.RULE.roomType_5){var n=new eui.Label("付费模式："+(1==Room.RULE.roomType_5?"房主付费":"AA制付费"));i(n),this.g_topBar.addChild(n)}this.topBarTimer.addEventListener(egret.TimerEvent.TIMER,function(){e.g_topBar.x-=2,e.g_topBar.x+e.g_topBar.width<290&&(e.g_topBar.x=916)},this),this.topBarTimer.start(),this.c_card_bottom.onGetCard(Player.HandCard),this.lb_cardNum.text="剩余："+this._cardNum+"张牌",this.c_timeArrow.timeTimer.start()},t.prototype.initUIListener=function(){this.btn_message.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTalk,this),this.btn_set.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetTap,this),this.c_btnHover.addEventListener(HoverEvent.CLICK_ITEM,this.onClick_Hover,this),this.addEventListener(EventName.SEND_FACE,this.onGetFace,this),this.addEventListener(EventName.SEND_TALK,this.onGetTalk,this)},t.prototype.onTs=function(e){console.log("onTs");for(var t=e.data.cheatList,i=0;i<t.length;i++){var n=Player.onSeat(t[i].index);if("bottom"!==n){console.log(n);for(var o=0;t[i].cards.length;o++)this.card_ts_left.onAddCard(t[i].cards[o]),this["card_ts_"+n].onAddCard(t[i].cards[o])}}},t.prototype.onTsTwo=function(e){console.log("onTsTwo");var t=Player.onSeat(e.data.index);"bottom"!==t&&(console.log(t),this["card_ts_"+t].onAddCard(e.data.card))},t.prototype.initSocketListener=function(){NetData.addEvt(NetData.CODE_TS,this.onTs,this),NetData.addEvt(NetData.CODE_TS_TWO,this.onTsTwo,this),NetData.addEvt(NetData.CODE_GAME_ADD_CARD_BY_SELF,this.onNetAddCard,this),NetData.addEvt(NetData.CODE_GAME_PUT_CARD,this.onNetPutCard,this),NetData.addEvt(NetData.CODE_GAME_AWRROW,this.onNetAwrrow,this),NetData.addEvt(NetData.CODE_GAME_EVENT_TING,this.onNetTing,this),NetData.addEvt(NetData.CODE_GAME_EVENT_HU,this.onNetHu,this),NetData.addEvt(NetData.CODE_GAME_EVENT_PENG,this.onNetPeng,this),NetData.addEvt(NetData.CODE_GAME_EVENT_SERVER_PENG,this.onNetShowPeng,this),NetData.addEvt(NetData.CODE_GAME_EVENT_GANG,this.onNetGang,this),NetData.addEvt(NetData.CODE_GAME_EVENT_SERVER_GANG,this.onNetShowGang,this),NetData.addEvt(NetData.CODE_GAME_EVENT_SHOW_CARD,this.onNetGameEnd,this),NetData.addEvt(NetData.CODE_GAME_EVENT_SELECTED_TING,this.onNetSelectTing,this),NetData.addEvt(NetData.CODE_PLAYER_CHAT,this.onGetFace,this),NetData.addEvt(NetData.CODE_GAME_LIUJU,this.onGameLiuJu,this),NetData.addEvt(NetData.CODE_GAME_EVENT_SURE_TING,this.onGameSureTing,this),NetData.addEvt(NetData.CODE_BIG_END,this.OnBigGameEnd,this),NetData.addEvt(NetData.CODE_GAME_OffLineImg,this.OnOffLineImg,this),NetData.addEvt(NetData.CODE_GAME_OnLineImg,this.OnOnLineImg,this),NetData.addEvt(NetData.CODE_SomePlayer_Exit,this.SomePlayerExit,this),NetData.addEvt(NetData.CODE_Game_CanExit,this.GameCanExit,this),NetData.addEvt(NetData.CODE_Game_validation,this.GameValidation,this),NetData.addEvt(NetData.CODE_GAME_FENG,this.onFengCard,this)},t.prototype.removePageListener=function(){this.btn_message.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTalk,this),this.btn_set.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetTap,this),this.c_btnHover.removeEventListener(HoverEvent.CLICK_ITEM,this.onClick_Hover,this),this.removeEventListener(EventName.SEND_FACE,this.onGetFace,this),this.removeEventListener(EventName.SEND_TALK,this.onGetTalk,this),NetData.removeEvt(NetData.CODE_TS,this.onTs,this),NetData.removeEvt(NetData.CODE_TS_TWO,this.onTsTwo,this),NetData.removeEvt(NetData.CODE_GAME_ADD_CARD_BY_SELF,this.onNetAddCard,this),NetData.removeEvt(NetData.CODE_GAME_PUT_CARD,this.onNetPutCard,this),NetData.removeEvt(NetData.CODE_GAME_AWRROW,this.onNetAwrrow,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_TING,this.onNetTing,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_HU,this.onNetHu,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_PENG,this.onNetPeng,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_SERVER_PENG,this.onNetShowPeng,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_GANG,this.onNetGang,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_SERVER_GANG,this.onNetShowGang,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_SHOW_CARD,this.onNetGameEnd,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_SELECTED_TING,this.onNetSelectTing,this),NetData.removeEvt(NetData.CODE_PLAYER_CHAT,this.onGetFace,this),NetData.removeEvt(NetData.CODE_GAME_LIUJU,this.onGameLiuJu,this),NetData.removeEvt(NetData.CODE_GAME_EVENT_SURE_TING,this.onGameSureTing,this),NetData.removeEvt(NetData.CODE_BIG_END,this.OnBigGameEnd,this),NetData.removeEvt(NetData.CODE_GAME_OffLineImg,this.OnOffLineImg,this),NetData.removeEvt(NetData.CODE_GAME_OnLineImg,this.OnOnLineImg,this),NetData.removeEvt(NetData.CODE_SomePlayer_Exit,this.SomePlayerExit,this),NetData.removeEvt(NetData.CODE_Game_CanExit,this.GameCanExit,this),NetData.removeEvt(NetData.CODE_Game_validation,this.GameValidation,this),NetData.removeEvt(NetData.CODE_GAME_FENG,this.onFengCard,this)},t.prototype.onClick_Hover=function(e){switch(console.log("点击HOVER"),e.data){case 3:this.addChild(new Page_How);break;case 5:this.onClick_Hover_Exit()}},t.prototype.GameValidation=function(e){this.gamealertValidation=new AlertValidation(2),this.addChild(this.gamealertValidation),this.gamealertValidation.childrenCreateder(e.data,this.startTime)},Object.defineProperty(t.prototype,"isAuto",{set:function(e){this._IsAuto=e,this.c_card_bottom.g_test.visible=e},enumerable:!0,configurable:!0}),t.prototype.onClick_Hover_AKF=function(){console.log("托管"),this.isAuto=!this._IsAuto,this._IsAuto&&(this.c_card_bottom.AuToText.text="正在托管....."),this.AUtoOnes()},t.prototype.AUtoOnes=function(){this.IsPlyaerOP&&this.onClick_Guo(),this.c_card_bottom.AuToOutCard(),this.cardBox&&this.cardBox.parent&&this.cardBox.parent.removeChild(this.cardBox)},t.prototype.onClick_Hover_Set=function(){console.log("设置"),this.dispatchEventWith(EventName.CREATE_PAGE_SET,!1)},t.prototype.onClick_Hover_Exit=function(){console.log("申请退出"),this.gamealertValidation=new AlertValidation(1),this.addChild(this.gamealertValidation),this.gamealertValidation.once(EventName.BTN_CHOOSE_NEXT,this.SureExitRoom,this),this.gamealertValidation.once(EventName.BTN_CHOOSE_PRE,this.DisSureExitRoom,this)},t.prototype.SureExitRoom=function(){var e={cmd:NetData.CODE_SomePlayer_Exit,msg:[{playerId:Player.OPENID,roomId:Room.NUMBER}]};SocketUtil.getInstance().onSendMessage(e)},t.prototype.DisSureExitRoom=function(){},t.prototype.SomePlayerExit=function(e){this.startTime=egret.getTimer(),this.alertButtoner=new AlertButtonPage("玩家"+e.data[0].nickname+"正在申请解散房间，您是否同意解散？",2),this.addChild(this.alertButtoner),this.alertButtoner.once(EventName.BTN_CHOOSE_PRE,this.DisSureExitRoom2,this),this.alertButtoner.once(EventName.BTN_CHOOSE_NEXT,this.SureExitRoom2,this)},t.prototype.SureExitRoom2=function(){var e={cmd:NetData.CODE_Game_isvalidation,msg:[{playerId:Player.OPENID,roomId:Room.NUMBER,status:!0}]};SocketUtil.getInstance().onSendMessage(e)},t.prototype.DisSureExitRoom2=function(){var e={cmd:NetData.CODE_Game_isvalidation,msg:[{playerId:Player.OPENID,roomId:Room.NUMBER,status:!1}]};SocketUtil.getInstance().onSendMessage(e)},t.prototype.GameCanExit=function(e){var t=this;if(this.gamealertValidation&&this.gamealertValidation.parent&&this.gamealertValidation.parent.removeChild(this.gamealertValidation),this.alertButtoner&&this.alertButtoner.parent&&this.alertButtoner.parent.removeChild(this.alertButtoner),e.data[0].status){var i=new AlertPage("所有在线玩家已同意解散房间，即将返回大厅!");this.addChild(i),i.once(egret.Event.REMOVED_FROM_STAGE,function(){i.removeEventListener(EventName.BTN_CHOOSE_OK,t.SureExitRoom3,t)},this),i.once(EventName.BTN_CHOOSE_OK,this.SureExitRoom3,this)}else{var n=new AlertPage("有玩家拒绝解散房间,请您继续游戏。");this.addChild(n)}},t.prototype.SureExitRoom3=function(){IframeManager.getInstance().backToHall()},t.prototype.onTalk=function(){console.log("文字"),this.dispatchEventWith(EventName.CREATE_PAGE_TALK,!0)},t.prototype.onSetTap=function(){console.log("设置"),this.dispatchEventWith(EventName.CREATE_PAGE_SET,!0)},t.prototype.onGetFace=function(e){if("expression"==e.data[0].message.substr(0,10)){var t=new FaceAct(e.data[0].message);switch(console.log("face="+Global.playerFace),this["g_"+Player.onSeat(e.data[0].index)+"_act"].addChild(t),Player.onSeat(e.data[0].index)){case"top":t.x=-149,t.y=-102;break;case"bottom":t.x=-133,t.y=23;break;case"left":t.x=-132,t.y=-78;break;case"right":t.x=213,t.y=-117}}else{var i=new TalkPage(e.data[0].message,Player.onSeat(e.data[0].index));-1!=Global.CheckTalk(e.data[0].message)&&(1==e.data[0].sex?Sound.getInstance().playerEffc("man_chat"+Global.CheckTalk(e.data[0].message)):Sound.getInstance().playerEffc("woman_chat"+Global.CheckTalk(e.data[0].message))),this["g_"+Player.onSeat(e.data[0].index)+"_act"].addChild(i),egret.Tween.get(i).wait(1500).to({alpha:0},1e3).call(i.onRemoveStage)}},t.prototype.onGetTalk=function(e){},t.prototype.onNetAddCard=function(e){console.log("GamePage摸牌消息:"+JSON.stringify(e.data[0])),this.lb_cardNum.text="剩余："+--this._cardNum+"张牌",this._OpCardIndex=e.data[0].index,e.data[0].card>0&&(this.IsMoCard=!0,this.c_card_bottom.onAddCard(e.data[0].card),this.c_card_bottom.isPut=!0),this.c_timeArrow.SetArrow=Player.onSeat(e.data[0].index),this.c_timeArrow.SetTime=15},t.prototype.onFengCard=function(e){Room.FENG_CARD=e.data[0],this.c_card_bottom.showFengCard()},t.prototype.onNetPutCard=function(e){Sound.getInstance().playerEffc("put_card"),this.IsMoCard=!1,this._OutCardIndex=parseInt(e.data[0].index),1!=e.data[0].tingCardFlag&&Sound.getInstance().playerEffc("CardEfc_"+e.data[0].card),this["c_cardShow_"+Player.onSeat(e.data[0].index)].onAddCard(e.data[0].card,e.data[0].tingCardFlag)},t.prototype.onNetAwrrow=function(e){this.c_timeArrow.onResetArrow(),this.c_timeArrow.SetTime=15},t.prototype.onNetPeng=function(e){this.c_timeArrow.SetTime=15,this.c_timeArrow.onResetArrow(),console.log("GamePage碰消息:"+JSON.stringify(e.data[0])),this._IsAuto?(this.onClick_Guo(),console.log("托管状态碰已经被取消了")):(this._OpCardIndex=Player.SeatNumber,this.c_player_PGH.visible=!0,this.c_player_PGH.showBtn(this.c_player_PGH.btnType_peng),this.IsPlyaerOP=!0,this.PengCard=e.data[0].card,this.zimo=e.data[0].zimo,this.c_player_PGH.addEventListener("Peng",this.onclick_Peng,this),this.c_player_PGH.addEventListener("Guo",this.onClick_Guo,this))},t.prototype.onNetShowPeng=function(e){Sound.getInstance().playerEffc("MJ_card_peng"+Math.floor(3*Math.random()+1)),this.M_PlayersCurOutCard.parent.contains(this.M_PlayersCurOutCard)&&(this.M_PlayersCurOutCard.parent.removeChild(this.M_PlayersCurOutCard),this["c_cardShow_"+Player.onSeat(this._OutCardIndex)].cardIndex--),this["c_card_"+Player.onSeat(e.data[0].index)].OnPengCard(e.data[0].card),this.c_timeArrow.SetArrow=Player.onSeat(e.data[0].index),this.c_timeArrow.SetTime=15
},t.prototype.onNetShowGang=function(e){this.isangang=e.data[0].zimo,Sound.getInstance().playerEffc("MJ_card_gang"+Math.floor(2*Math.random()+1)),0==e.data[0].zimo&&(this.c_timeArrow.SetTime=15,this.c_timeArrow.onResetArrow(),this.M_PlayersCurOutCard.parent.contains(this.M_PlayersCurOutCard)&&(this.M_PlayersCurOutCard.parent.removeChild(this.M_PlayersCurOutCard),this["c_cardShow_"+Player.onSeat(this._OutCardIndex)].cardIndex--)),this.c_timeArrow.SetArrow=Player.onSeat(e.data[0].index),this.c_timeArrow.SetTime=15,this["c_card_"+Player.onSeat(e.data[0].index)].OnGangCard(e.data[0].card,e.data[0].zimo)},t.prototype.onNetGameEnd=function(e){Global.endInfo=e.data;for(var t=0;4>t;t++)"胡牌"==Global.endInfo[t].type?Sound.getInstance().playerEffc("MJ_card_hu"+Math.floor(2*Math.random()+1)):"自摸"==Global.endInfo[t].type?Sound.getInstance().playerEffc("MJ_card_hu"+Math.floor(2*Math.random()+1)):"流局"==Global.endInfo[t].type&&console.log("流局");Global.mainScene.onCreateEnd(),Statics.IsSecond=!0},t.prototype.OnBigGameEnd=function(e){Global.endBigInfo=e.data,Global.mainScene.onCreateBigEnd()},t.prototype.onNetGang=function(e){this._OpCardIndex=Player.SeatNumber,this._IsAuto&&"正在托管....."==this.c_card_bottom.AuToText.text?(this.onClick_Guo(),console.log("托管杠状态已经被取消了")):(this.GangEvent.data=e.data,this.zimo=e.data[0].zimo,this.zimoer=e.data[0].zimo,console.log(this.zimoer),console.log("GamePage杠消息:"+JSON.stringify(e.data[0])),this.c_player_PGH.visible=!0,this.c_player_PGH.showBtn(this.c_player_PGH.btnType_gang),this.IsPlyaerOP=!0,e.data[0].gangList.length>1?this.GangCard=e.data[0].gangList:this.GangCard=e.data[0].gangList[0],this.c_player_PGH.addEventListener("Gang",this.onclick_Gang,this),this.c_player_PGH.addEventListener("Guo",this.onClick_Guo,this))},t.prototype.onNetTing=function(e){this._OpCardIndex=Player.SeatNumber,this._IsAuto&&"正在托管....."==this.c_card_bottom.AuToText.text?(this.onClick_Guo(),console.log("托管听状态已经被取消了")):(console.log("GamePage听消息:"+JSON.stringify(e.data[0])),this.TingEvent.data=e.data,this.c_player_PGH.visible=!0,this.c_player_PGH.showBtn(this.c_player_PGH.btnType_ting),this.IsPlyaerOP=!0,this.tings=e.data[0].tingSet,this.c_player_PGH.addEventListener("Ting",this.onClick_Ting,this),this.c_player_PGH.addEventListener("Guo",this.onClick_Guo,this))},t.prototype.onNetHu=function(e){console.log("GamePage胡消息:"+JSON.stringify(e.data[0])),this.IsReadyTing=this._IsAuto,this.IsHuOp=!0,this._IsAuto=!1,this.zimo=e.data[0].zimo,this._OpCardIndex=Player.SeatNumber,this.c_player_PGH.visible=!0,this.c_player_PGH.showBtn(this.c_player_PGH.btnType_hu),this.huType=e.data[0].huType,this.huCard=e.data[0].card,this.c_player_PGH.addEventListener("Hu",this.onClick_Hu,this),this.c_player_PGH.addEventListener("Guo",this.onClick_Guo,this)},t.prototype.onclick_Peng=function(){this.c_player_PGH.removeEventListener("Peng",this.onClick_Ting,this),this.c_player_PGH.visible=!1,this.c_player_PGH.init();var e={cmd:NetData.CODE_GAME_EVENT_SURE_PENG,msg:[{roomId:Room.NUMBER,card:this.PengCard,index:Player.SeatNumber,zimo:this.zimo}]};SocketUtil.getInstance().onSendMessage(e),this.IsPlyaerOP=!1},t.prototype.onclick_Gang=function(){var e=this;if(this.GangCard.length>1)this.cardBox=new CardBox,this.cardBox.horizontalCenter=0,this.cardBox.bottom=150,this.cardBox.BoxCloseFun=function(){console.log("this.GangEvent:"+JSON.stringify(e.GangEvent)),e.onNetGang(e.GangEvent)},this.addChild(this.cardBox),this.cardBox.visible=!0,this.cardBox.onAddGang(this.GangCard),this.cardBox.once("Gang",this.onSelectGang,this);else{var t={cmd:NetData.CODE_GAME_EVENT_SURE_GANG,msg:[{roomId:Room.NUMBER,card:this.GangCard,index:Player.SeatNumber,zimo:this.zimo}]};SocketUtil.getInstance().onSendMessage(t),this.IsPlyaerOP=!1}this.c_player_PGH.removeEventListener("Gang",this.onclick_Gang,this),this.c_player_PGH.visible=!1,this.c_player_PGH.init()},t.prototype.onSelectGang=function(e){this.GangCard=e.data,this.c_player_PGH.removeEventListener("Gang",this.onclick_Gang,this),this.c_player_PGH.visible=!1,this.c_player_PGH.init();var t={cmd:NetData.CODE_GAME_EVENT_SURE_GANG,msg:[{roomId:Room.NUMBER,card:this.GangCard,index:Player.SeatNumber,zimo:this.zimo}]};SocketUtil.getInstance().onSendMessage(t),this.IsPlyaerOP=!1,this.cardBox&&this.cardBox.parent&&this.cardBox.parent.removeChild(this.cardBox)},t.prototype.onClick_Ting=function(){var e=this;this.c_player_PGH.removeEventListener("Ting",this.onClick_Ting,this),this.c_player_PGH.visible=!1,this.c_player_PGH.init(),this.cardBox=new CardBox,this.cardBox.BoxCloseFun=function(){e.onNetTing(e.TingEvent)},this.cardBox.horizontalCenter=0,this.cardBox.bottom=150,this.addChild(this.cardBox),this.cardBox.visible=!0,this.cardBox.onAddCard(this.tings),this.cardBox.once("Ting",this.onSelectTing,this)},t.prototype.onClick_Hu=function(){this.c_player_PGH.removeEventListener("Hu",this.onClick_Hu,this),this.c_player_PGH.visible=!1,this.c_player_PGH.init();var e={cmd:NetData.CODE_GAME_EVENT_SURE_HU,msg:[{playerId:Player.OPENID,roomId:Room.NUMBER,card:this.huCard,index:Player.SeatNumber,huType:this.huType,zimo:this.zimo}]};SocketUtil.getInstance().onSendMessage(e),this.huCard=-1},t.prototype.onClick_Guo=function(){this.c_player_PGH.visible=!1,this.c_player_PGH.init();var e={cmd:NetData.CODE_GAME_EVENT_GUO,msg:[{playerId:Player.OPENID,roomId:Room.NUMBER,index:Player.SeatNumber}]};SocketUtil.getInstance().onSendMessage(e),this.IsPlyaerOP=!1,this.IsReadyTing&&this.IsHuOp&&(this._IsAuto=!0,this.IsReadyTing=!1,this.IsHuOp=!1,console.log(this.zimo+"0000"),console.log(this.zimoer+"88888"),1==this.zimo&&1==this._IsAuto&&this.c_card_bottom.AuToOutCard()),1==this.zimoer&&1==this._IsAuto?this.c_card_bottom.AuToOutCard():2==this.zimoer&&1==this._IsAuto&&this.c_card_bottom.AuToOutCard()},t.prototype.onSelectTing=function(e){this.c_card_bottom.isTing=!0,this.c_card_bottom.RemoveHoldCard(e.data),this.tingCard=e.data;var t={cmd:NetData.CODE_GAME_EVENT_SELECTED_TING,msg:[{playerId:Player.OPENID,roomId:Room.NUMBER,card:this.tingCard,index:Player.SeatNumber}]};SocketUtil.getInstance().onSendMessage(t),this.IsPlyaerOP=!1,this.cardBox&&this.cardBox.parent&&this.cardBox.parent.removeChild(this.cardBox),this.isAuto=!0,this.c_card_bottom.AuToText.text="已听牌.....","已听牌....."==this.c_card_bottom.AuToText.text||this.onClick_Hover_AKF()},t.prototype.onGameSureTing=function(e){Sound.getInstance().playerEffc("MJ_card_ting1"),Player.ting||(Player.ting=e.data[0].index==Player.SeatNumber?!0:!1,this.c_card_bottom.showTingCard()),e.data[0].index!=Player.SeatNumber&&this["c_player_"+Player.onSeat(e.data[0].index)].showTing()},t.prototype.onNetSelectTing=function(e){this["c_cardShow_"+Player.onSeat(e.data[0].index)].onAddHideCard(),Player.SeatNumber==e.data[0].index},t.prototype.OffOnLineCome=function(e,t){for(var i=0;4>i;i++){this._OutCardIndex=e[i].index,this["c_cardShow_"+Player.onSeat(e[i].index)].OffOnLineCome(e[i].putArr,e[i].tingCardIndex),Player.SeatNumber==e[i].index&&e[i].tingCardIndex&&(this.isAuto=!0,this.c_card_bottom.AuToText.text="已听牌.....","已听牌....."==this.c_card_bottom.AuToText.text||this.onClick_Hover_AKF(),console.log("已听牌 --- "),Player.ting=!0,this.c_card_bottom.showTingCard());var n=null;n=void 0!=e[i].cardArr?e[i].cardArr:"",this["c_card_"+Player.onSeat(e[i].index)].OffOnLineCome(n,e[i].cardArrSize,e[i].pengArr,e[i].gangArr,e[i].touchCard)}this.c_timeArrow.SetArrow=Player.onSeat(t),Player.SeatNumber==t&&(this.c_card_bottom.isPut=!0)},t.prototype.OnOffLineImg=function(e){this["c_player_"+Player.onSeat(e.data[0].index)].OffLine.visible=!0},t.prototype.OnOnLineImg=function(e){this["c_player_"+Player.onSeat(e.data[0].index)].OffLine.visible=!1},t.prototype.ShowVoice=function(e){this["c_player_"+Player.onSeat(e)].ShowVoice.visible=!0,this["c_player_"+Player.onSeat(e)].onRecording()},t.prototype.HideVoice=function(){this.c_player_top.ShowVoice.visible=!1,this.c_player_bottom.ShowVoice.visible=!1,this.c_player_right.ShowVoice.visible=!1,this.c_player_left.ShowVoice.visible=!1,this.c_player_top.onRecordEnd(),this.c_player_bottom.onRecordEnd(),this.c_player_right.onRecordEnd(),this.c_player_left.onRecordEnd()},t.prototype.onGameLiuJu=function(){var e={cmd:1201,msg:[{roomId:Room.NUMBER,isLiuJu:!0}]};SocketUtil.getInstance().onSendMessage(e)},t}(eui.Component);__reflect(GamePage.prototype,"GamePage");var GamePGHPage=function(e){function t(){var t=e.call(this)||this;return t.btn_ting=new eui.Image,t.btn_hu=new eui.Image,t.btn_gang=new eui.Image,t.btn_peng=new eui.Image,t.btn_guo=new eui.Image,t.btnType_hu="btn_hu",t.btnType_gang="btn_gang",t.btnType_peng="btn_peng",t.btnType_ting="btn_ting",t.btnArr=[],t.skinName="resource/skins/game/GamePGHSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.bottom=100,this.right=100,this.once(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_ting.source="hupai_ting_png",this.btn_hu.source="hupai_hu_png",this.btn_gang.source="hupai_gang_png",this.btn_peng.source="hupai_peng_png",this.btn_guo.source="hupai_guo_png",this.g_PGHG.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGroupTap,this)},t.prototype.onRemoveStage=function(){this.g_PGHG.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGroupTap,this)},t.prototype.onGroupTap=function(e){var t=e.target.source;if(console.log("点击了 -- "+t),null!=t)switch(t){case"hupai_hu_png":this.dispatchEvent(new egret.Event("Hu"));break;case"hupai_gang_png":this.dispatchEvent(new egret.Event("Gang"));break;case"hupai_peng_png":this.dispatchEvent(new egret.Event("Peng"));break;case"hupai_guo_png":this.dispatchEvent(new egret.Event("Guo"));break;case"hupai_ting_png":this.dispatchEvent(new egret.Event("Ting"))}},t.prototype.showBtn=function(e){this.btnArr.push(e),this.initGroup(),this[e].touchEnabled=!0},t.prototype.initGroup=function(){this.g_PGHG.removeChildren(),-1!=this.btnArr.indexOf(this.btnType_ting)&&this.g_PGHG.addChild(this.btn_ting),-1!=this.btnArr.indexOf(this.btnType_hu)&&this.g_PGHG.addChild(this.btn_hu),-1!=this.btnArr.indexOf(this.btnType_gang)&&this.g_PGHG.addChild(this.btn_gang),-1!=this.btnArr.indexOf(this.btnType_peng)&&this.g_PGHG.addChild(this.btn_peng),this.g_PGHG.addChild(this.btn_guo)},t.prototype.init=function(){this.visible=!1,this.g_PGHG.removeChildren(),this.btnArr=[]},t}(eui.Component);__reflect(GamePGHPage.prototype,"GamePGHPage");var GameTimeArrowPage=function(e){function t(){var t=e.call(this)||this;return t.timeTimer=new egret.Timer(1e3),t.IsMyTimerOut=!1,t.skinName="resource/skins/game/GameTimeArrow.exml",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.init,t),t}return __extends(t,e),Object.defineProperty(t.prototype,"SetArrow",{get:function(){return this._SetArrow},set:function(e){this._SetArrow=e,e==Statics.ARROW_TOP?this.onArrow("top"):e==Statics.ARROW_BOTTOM?this.onArrow("bottom"):e==Statics.ARROW_LEFT?this.onArrow("left"):e==Statics.ARROW_RIGHT&&this.onArrow("right")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SetTime",{get:function(){return this._SetTime},set:function(e){this._SetTime=e,this.lb_time.text=e.toString()},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.timeTimer.addEventListener(egret.TimerEvent.TIMER,this.timerfun,this)},t.prototype.timerfun=function(){this._SetTime>0&&(--this._SetTime,this.lb_time.text=this._SetTime.toString())},t.prototype.removeArrowListener=function(){this.timeTimer.stop(),this.timeTimer.addEventListener(egret.TimerEvent.TIMER,this.timerfun,this)},t.prototype.onArrow=function(e){this.onResetArrow(),this["img_"+e].visible=!0},t.prototype.onResetArrow=function(){this.img_top.visible=this.img_bottom.visible=!1,this.img_left.visible=this.img_right.visible=!1},t}(eui.Component);__reflect(GameTimeArrowPage.prototype,"GameTimeArrowPage");var GameUserPage=function(e){function t(){var t=e.call(this)||this;return t.recordIndex=0,t.skinName="resource/skins/GameUserSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.OffLine.visible=!1,this.once(egret.Event.REMOVED_FROM_STAGE,this.onDistory,this),this.g_none.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSitDownTap,this)},t.prototype.onRecording=function(){var e=this;egret.Tween.get(this.img_recording).call(function(){e.recordIndex<4?++e.recordIndex:e.recordIndex=0,e.img_recording.source=RES.getRes("img_record"+e.recordIndex+"_png")},this).wait(100).call(function(){e.onRecording()},this)},t.prototype.onRecordEnd=function(){egret.Tween.removeTweens(this.img_recording)},t.prototype.onDistory=function(){this.g_none.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSitDownTap,this)},t.prototype.onSitDownTap=function(){this.dispatchEvent(new egret.Event(EventName.BTN_SITDOWN))},Object.defineProperty(t.prototype,"SetHeadImg",{get:function(){return this._SetHeadImg},set:function(e){this._SetHeadImg=e,this.img_head.source=e,this.img_head.mask=this.img_headMask},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SetNickName",{get:function(){return this._SetNickName},set:function(e){this._SetNickName=e,this.lb_nickname.text=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SetMoney",{get:function(){return this._SetMoney},set:function(e){this._SetMoney=e,this.lb_money.text=e.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsHead",{get:function(){return this._IsHead},set:function(e){this._IsHead=e,e?(this.g_head.visible=!0,this.g_none.visible=!1):(this.g_head.visible=!1,this.g_none.visible=!0)},enumerable:!0,configurable:!0}),t.prototype.showTing=function(){this.img_ting.visible=!0},t}(eui.Component);__reflect(GameUserPage.prototype,"GameUserPage");var GameEndPengGang=function(e){function t(t){var i=e.call(this)||this;return i.skinName="resource/skins/game/PengGang/GameEndPengGangSkin.exml",i.type=t,i}return __extends(t,e),Object.defineProperty(t.prototype,"SetFace",{get:function(){return this._SetFace},set:function(e){this._SetFace=e,this.type==Statics.GE_TYPE_PENG?(this.img_cardLeft.source=this.img_cardBottom.source=this.img_cardRight.source=RES.getRes("card_show_bottom"+e+"_png"),this.img_cardTop.visible=!1):this.type==Statics.GE_TYPE_GANG_MING?this.img_cardLeft.source=this.img_cardBottom.source=this.img_cardRight.source=this.img_cardTop.source=RES.getRes("card_show_bottom"+e+"_png"):this.type==Statics.GE_TYPE_GANG_AN&&(this.img_cardLeft.source=this.img_cardBottom.source=this.img_cardRight.source=RES.getRes("card_show_bottom"+e+"_png"),this.img_cardTop.source=RES.getRes("card_hide_bottom_png"))},enumerable:!0,configurable:!0}),t.prototype.childrenCreated=function(){},t}(eui.Component);__reflect(GameEndPengGang.prototype,"GameEndPengGang");var GamePengGang=function(e){function t(t){var i=e.call(this)||this;return i.skinName="resource/skins/game/PengGang/GamePengGangSkin.exml",i.type=t,i}return __extends(t,e),Object.defineProperty(t.prototype,"SetFace",{get:function(){return this._SetFace},set:function(e){this._SetFace=e,this.type==Statics.GE_TYPE_PENG?(this.img_cardLeft.source=this.img_cardBottom.source=this.img_cardRight.source=RES.getRes("card_show_bottom"+e+"_png"),this.img_cardTop.source=null):this.type==Statics.GE_TYPE_GANG_MING?this.img_cardLeft.source=this.img_cardBottom.source=this.img_cardRight.source=this.img_cardTop.source=RES.getRes("card_show_bottom"+e+"_png"):this.type==Statics.GE_TYPE_GANG_AN&&(this.img_cardLeft.source=this.img_cardBottom.source=this.img_cardRight.source=RES.getRes("card_show_bottom"+e+"_png"),this.img_cardTop.source=RES.getRes("card_hide_bottom_png"))},enumerable:!0,configurable:!0}),t.prototype.childrenCreated=function(){},t}(eui.Component);__reflect(GamePengGang.prototype,"GamePengGang");var GamePengGangAct=function(e){function t(t){var i=e.call(this)||this;return i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onInit,i),t==Statics.GE_TYPE_PENG?i.source=RES.getRes("icon_game_peng_png"):t==Statics.GE_TYPE_HU?i.source=RES.getRes("icon_game_hu_png"):(t==Statics.GE_TYPE_GANG_AN||t==Statics.GE_TYPE_GANG_MING)&&(i.source=RES.getRes("icon_game_gang_png")),i}return __extends(t,e),t.prototype.onInit=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onInit,this),this.alpha=0,this.scaleX=this.scaleY=.5,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2;var e=egret.Tween.get(this);e.to({alpha:1},1).to({scaleX:2,scaleY:2},1e3).to({scaleX:1,scaleY:1},500).wait(100).to({alpha:0},500).call(this.onRemoveStage)},t.prototype.onRemoveStage=function(){this&&this.parent&&this.parent.removeChild(this)},t}(eui.Image);__reflect(GamePengGangAct.prototype,"GamePengGangAct");var GameEndItemPage=function(e){function t(t,i,n,o,a){var r=e.call(this)||this;return r.pengs=[],r.gangs_m=[],r.gangs_a=[],r.others=[],r.hu=0,r.cardWidth=46,r.cardScale=.9,r.cardWidthP=r.cardWidth*r.cardScale,r.skinName="resource/skins/item/GameEndItem.exml",r.pengs=t,r.gangs_m=i,r.gangs_a=n,r.others=o,r.hu=a,r}return __extends(t,e),t.prototype.childrenCreated=function(){if(0!=this.others.length)for(var e=0;e<this.others.length;e++){var t=new Card(Statics.CARD_TYPE_SHOW_BOTTOM);t.scaleX=t.scaleY=this.cardScale,t.SetFaceNumber=this.others[e],t.x=e*this.cardWidthP,t.bottom=0,this.g_card.addChild(t),this.g_card.setChildIndex(t,0)}if(0!=this.hu){var t=new Card(Statics.CARD_TYPE_SHOW_BOTTOM);t.scaleX=t.scaleY=this.cardScale,t.SetFaceNumber=this.hu,t.x=this.g_card.numChildren*this.cardWidthP+10,t.bottom=0,this.g_card.addChild(t),this.g_card.setChildIndex(t,0)}var i=5;if(0!=this.pengs.length)for(var e=0;e<this.pengs.length;e++){var n=new GameEndPengGang(Statics.GE_TYPE_PENG);n.scaleX=n.scaleY=this.cardScale,n.SetFace=this.pengs[e],n.x=this.g_card.width+i,this.g_card.addChild(n)}if(0!=this.gangs_m.length)for(var e=0;e<this.gangs_m.length;e++){var o=new GameEndPengGang(Statics.GE_TYPE_GANG_MING);o.scaleX=o.scaleY=this.cardScale,o.SetFace=this.gangs_m[e],o.x=this.g_card.width+i,this.g_card.addChild(o)}if(0!=this.gangs_a.length)for(var e=0;e<this.gangs_a.length;e++){var o=new GameEndPengGang(Statics.GE_TYPE_GANG_AN);o.scaleX=o.scaleY=this.cardScale,o.SetFace=this.gangs_a[e],o.x=this.g_card.width+i,this.g_card.addChild(o)}},t}(eui.Component);__reflect(GameEndItemPage.prototype,"GameEndItemPage");var Page_Chat=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageChatSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.init(),this.addEvent()},t.prototype.init=function(){this.rbtn_talk.selected=!0,this.g_talk.visible=!0,this.talks=[{lb:"大家好，很高兴见到各位！"},{lb:"快点吧，我等到花儿都谢了。"},{lb:"不要走，决战到天亮。"},{lb:"君子报仇，十盘不算晚。"},{lb:"快放炮吧，我都等得不耐烦了。"},{lb:"真不好意思，又胡了。"},{lb:"打错了，呜呜呜呜。"}],this.list_talk.scrollEnabled=!1,this.list_talk.dataProvider=new eui.ArrayCollection(this.talks),this.list_talk.itemRenderer=Item_Talk},t.prototype.addEvent=function(){this.once(egret.Event.REMOVED_FROM_STAGE,this.onDistory,this),this.rbtn_face.addEventListener(egret.Event.CHANGE,this.onTab,this),this.rbtn_talk.addEventListener(egret.Event.CHANGE,this.onTab,this),this.rect_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBgTap,this),this.list_talk.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTalkTap,this),this.faceGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFaceTap,this)},t.prototype.onTab=function(e){switch(e.currentTarget){case this.rbtn_talk:this.g_talk.visible=!0,this.g_face.visible=!1;break;case this.rbtn_face:this.g_face.visible=!0,this.g_talk.visible=!1}},t.prototype.onTalkTap=function(e){var t={cmd:NetData.CODE_PLAYER_CHAT,msg:[{roomId:Room.NUMBER,message:e.currentTarget.selectedItem.lb,index:Player.SeatNumber}]};SocketUtil.getInstance().onSendMessage(t),this.parent.removeChild(this)},t.prototype.onFaceTap=function(e){console.log(e.target.source);var t={cmd:NetData.CODE_PLAYER_CHAT,msg:[{roomId:Room.NUMBER,message:e.target.source,index:Player.SeatNumber}]};SocketUtil.getInstance().onSendMessage(t),this.parent.removeChild(this)},t.prototype.onBgTap=function(){this.parent.removeChild(this)},t.prototype.onDistory=function(){this.rbtn_face.removeEventListener(egret.Event.CHANGE,this.onTab,this),this.rbtn_talk.removeEventListener(egret.Event.CHANGE,this.onTab,this),this.rect_bg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBgTap,this)},t}(eui.Component);__reflect(Page_Chat.prototype,"Page_Chat");var Item_Talk=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/item/item_TalkSkin.exml",t}return __extends(t,e),t}(eui.ItemRenderer);__reflect(Item_Talk.prototype,"Item_Talk");var Page_How=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageHowSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.top=this.bottom=this.left=this.right=0,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this)},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this&&this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(Page_How.prototype,"Page_How");var Page_Join=function(e){function t(t){void 0===t&&(t="");var i=e.call(this)||this;return i.inputIndex=1,i.inputNumber="",i.roomid="",i.AniNunm=2,i.skinName="resource/skins/page/PageJoinSkin.exml",i.roomid=t,i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i.init,i),i}return __extends(t,e),t.prototype.init=function(){this.JoInGroup.alpha=0,this.left=this.right=this.top=this.bottom=0,this.JoinPageAni(),this.initUIListerner(),this.initSocketListerner(),this.addEventListener(EventName.REMOVEJOIN,this.removethis,this)},t.prototype.removethis=function(){this.parent&&this.parent.removeChild(this)},t.prototype.JoinPageAni=function(){var e=this;if(this.AniNunm<20){this.JoInBG.scrollRect=new egret.Rectangle(0,0,941,750*(this.AniNunm/20));var t=egret.Tween.get(this.JoInBG);t.wait(10).call(function(){e.AniNunm++,e.JoinPageAni()},this)}else{egret.Tween.removeTweens(this.JoInGroup);var t=egret.Tween.get(this.JoInGroup);t.to({alpha:1},1e3).call(function(){""!=e.roomid&&e.AutoShowNumber(e.roomid)})}},t.prototype.EndJoInPageAni=function(){var e=this;if(this.AniNunm>0){this.JoInGroupGroup.scrollRect=new egret.Rectangle(0,0,941,750*(this.AniNunm/30));var t=egret.Tween.get(this.JoInGroupGroup);t.wait(10).call(function(){e.AniNunm--,e.EndJoInPageAni()},this)}else egret.Tween.removeTweens(this.JoInGroupGroup),this.onRemoveStage()},t.prototype.initUIListerner=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.EndJoInPageAni,this),this.g_input.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInputNumber,this),this.btn_ok.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOk,this)},t.prototype.initSocketListerner=function(){console.log("添加监听"),NetData.addEvt(NetData.CODE_ROOM_INFO,this.onGetRoomInfo,this),NetData.addEvt(NetData.CODE_JOIN_ROOM_SUCCESS,this.onGetRoomUser,this)},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.g_input.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInputNumber,this),this.btn_ok.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOk,this),this&&this.parent&&this.parent.removeChild(this)},t.prototype.onInputNumber=function(e){"num"==e.target.name.substr(0,3)?this.onShowNumber(e.target.name.substr(3,4)):"cle"==e.target.name.substr(0,3)?this.onClearNumber():"del"==e.target.name.substr(0,3)&&this.onDeleteNumber()},t.prototype.onShowNumber=function(e){this.inputIndex<=6&&(this["rect"+this.inputIndex].visible=!1,this["num"+this.inputIndex].source=RES.getRes(e+"_png"),this["num"+this.inputIndex].visible=!0,this.inputNumber=this.inputNumber+e.toString(),this.inputIndex++)},t.prototype.AutoShowNumber=function(e){var t=this;console.log(e+"22222222222222222222");for(var i=0;i<e.length;i++)this.onShowNumber(parseInt(e[i]));this.inputNumber=e,egret.setTimeout(function(){console.log("跳转房间"+t.inputNumber);var e={cmd:NetData.CODE_JOIN_BY_INPUT,msg:[{roomId:t.inputNumber}]};SocketUtil.getInstance().onSendMessage(e)},this,1e3)},t.prototype.onClearNumber=function(){this.inputIndex=1,this.inputNumber="";for(var e=1;6>=e;e++)this["rect"+e].visible=!0,this["num"+e].visible=!1},t.prototype.onDeleteNumber=function(){var e=this.inputIndex-1;this.inputNumber=this.inputNumber.substring(0,this.inputNumber.length-1),this["rect"+e].visible=!0,this["num"+e].visible=!1,this.inputIndex--},t.prototype.onOk=function(){if(7!=this.inputIndex)return void this.addChild(new AlertPage("房间号不正确！"));console.log("跳转房间"+this.inputNumber);var e={cmd:NetData.CODE_JOIN_BY_INPUT,msg:[{roomId:this.inputNumber}]};SocketUtil.getInstance().onSendMessage(e)},t.prototype.onGetRoomUser=function(e){NetData.removeEvt(NetData.CODE_JOIN_ROOM_SUCCESS,this.onGetRoomUser,this);for(var t=0,i=0;i<e.data.length;i++)null!=e.data[i]&&t++;Room.RoomPlayerInfo=e.data;var n={cmd:NetData.CODE_ROOM_INFO,msg:[]};SocketUtil.getInstance().onSendMessage(n)},t.prototype.onGetRoomInfo=function(e){NetData.removeEvt(NetData.CODE_ROOM_INFO,this.onGetRoomInfo,this),Room.NUMBER=e.data[0].roomId,Room.TIMES=e.data[0].times,Room.ALL_TIMES=e.data[0].allTimes,Room.RULE=Room.onGetRule(e.data[0].roomType_1),this.onRemoveStage(),console.log("触发onGetRoomInfo --------"),Global.mainScene&&Global.mainScene.onCreateTable()},t}(eui.Component);__reflect(Page_Join.prototype,"Page_Join");var Page_PlayerAni=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PagePlayerAniSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.player_1.IsHead=!1,this.player_2.IsHead=!1,this.player_3.IsHead=!1,this.player_4.IsHead=!1},t.prototype.setPlayer=function(e,t,i,n){if(void 0===t&&(t=!1),void 0===i&&(i=null),void 0===n&&(n=null),null!=e&&(this["player_"+e.index].recordIndex=e.index,this["player_"+e.index].IsHead=!0,this["player_"+e.index].SetNickName=FishUtil.limitNick(e.nickname),this["player_"+e.index].SetMoney=e.score,this["player_"+e.index].SetHeadImg=e.headImgUrl),t&&0!=Player.SeatNumber)switch(this.fun=i,this.loadObj=n,Player.SeatNumber){case 1:break;case 2:this.a2.addEventListener(egret.Event.COMPLETE,this.onAniComplete,this),this.a2.play(0);break;case 3:this.a3.addEventListener(egret.Event.COMPLETE,this.onAniComplete,this),this.a3.play(0);break;case 4:this.a4.addEventListener(egret.Event.COMPLETE,this.onAniComplete,this),this.a4.play(0)}},t.prototype.clearPlayer=function(e){this["player_"+e].IsHead=!1},t.prototype.initPlayer=function(){this.player_1.IsHead=!1,this.player_2.IsHead=!1,this.player_3.IsHead=!1,this.player_4.IsHead=!1},t.prototype.onAniComplete=function(){this.visible=!1,this.fun.call(this.loadObj)},t}(eui.Component);__reflect(Page_PlayerAni.prototype,"Page_PlayerAni");var Page_Record=function(e){function t(){var t=e.call(this)||this;return t.recordIndex=0,t.skinName="resource/skins/page/PageRecordSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_record.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartRecord,this),this.btn_record.addEventListener(egret.TouchEvent.TOUCH_END,this.onStopRecord,this),this.btn_record_bg.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onCancelRecord,this),IframeManager.getInstance().addEventListener(NetConstant.UPLOAD_VOICE_SUCCESS,this.onUploadSuccess,this),IframeManager.getInstance().addEventListener(NetConstant.PLAY_VOICE_SUCCESS,this.onPlayVoiceSuccess,this)},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_record.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStartRecord,this),this.btn_record.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStopRecord,this),this.btn_record_bg.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onCancelRecord,this),IframeManager.getInstance().removeEventListener(NetConstant.UPLOAD_VOICE_SUCCESS,this.onUploadSuccess,this),IframeManager.getInstance().removeEventListener(NetConstant.PLAY_VOICE_SUCCESS,this.onPlayVoiceSuccess,this),this&&this.parent&&this.parent.removeChild(this)},t.prototype.onStartRecord=function(){this.startTime=egret.getTimer(),this.g_show.visible=!0,this.onRecording();egret.localStorage.getItem("IsFirst");IframeManager.getInstance().startRecord(),console.log("录音开始"),1==Sound.isPlay&&1==Sound.isPlaying&&Sound.getInstance().SetBgmVolume(0)},t.prototype.onStopRecord=function(e,t){void 0===t&&(t=1),console.log("录音结束"),this.g_show.visible=!1,this.show.stop(),this.show.hasEventListener(egret.Event.COMPLETE)&&this.show.removeEventListener(egret.Event.COMPLETE,this.onTweenComplete,this),egret.getTimer()-this.startTime>1e3?IframeManager.getInstance().stopRecord(t):(IframeManager.getInstance().stopRecord(0),this.showLabel()),1==Sound.isPlay&&1==Sound.isPlaying&&Sound.getInstance().SetBgmVolume(Sound.getInstance().bgmVolume)},t.prototype.onCancelRecord=function(){this.onStopRecord(null,0)},t.prototype.onUploadSuccess=function(e){var t=e.data,i={cmd:NetData.CODE_Game_Record,msg:[{record:t,roomId:Room.NUMBER}]};SocketUtil.getInstance().onSendMessage(i)},t.prototype.onPlayVoiceSuccess=function(){Global.mainScene.HideRecord()},t.prototype.onRecording=function(){this.show.hasEventListener(egret.Event.COMPLETE)||this.show.addEventListener(egret.Event.COMPLETE,this.onTweenComplete,this),this.show.play(0)},t.prototype.onTweenComplete=function(){this.g_show.visible&&this.show.play(0)},t.prototype.showLabel=function(){var e=egret.Tween.get(this.group);e.to({visible:!0,y:366}).to({y:356},400,egret.Ease.cubicOut).wait(650).to({y:346,visible:!1},300)},t}(eui.Component);__reflect(Page_Record.prototype,"Page_Record");var Page_RoomList=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageRoomSc.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){var e=this;this.top=this.left=this.bottom=this.right=0,this._Share.left=this._Share.right=this._Share.top=this._Share.bottom=0,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRoomList,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomList,this),this._Share.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e._Share.visible=!1,e._Share.touchEnabled=!1},this),console.log(this._Share)},t.prototype.ListDate=function(e){var t=e;this.r_collection=new eui.ArrayCollection(t[0]),this.list_roomList.dataProvider=this.r_collection,this.list_roomList.itemRenderer=Roomlist},t.prototype.onRoomList=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRoomList,this),this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRoomList,this),this&&this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(Page_RoomList.prototype,"Page_RoomList");var Roomlist=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageRoomSingSkin.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){this.all.text=this.data.allTimes,this.room.text=this.data.roomId,console.log(this.data.size),this.size.text=this.data.size+"/4",""==this.data.allTimes?(this.parent.parent.parent.parent.parent.roomtitle.visible=!1,this.parent.parent.parent.parent.parent.page_sc.visible=!0):(this.parent.parent.parent.parent.parent.roomtitle.visible=!0,this.parent.parent.parent.parent.parent.page_sc.visible=!1),this.btn_yangqing.addEventListener(egret.TouchEvent.TOUCH_TAP,this.oninvite,this)},t.prototype.oninvite=function(){this.parent.parent.parent.parent.parent._Share.touchEnabled=!0,this.parent.parent.parent.parent.parent._Share.visible=!0},t}(eui.ItemRenderer);__reflect(Roomlist.prototype,"Roomlist");var Page_Score=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageScoreSkin.exml",t
}return __extends(t,e),t.prototype.childrenCreated=function(){this.top=this.left=this.bottom=this.right=0,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.btn_score_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.m_collection=new eui.ArrayCollection(Statics.ScoreDate),this.list_score.dataProvider=this.m_collection,this.list_score.itemRenderer=Page_Score_Singe},t.prototype.ReadData=function(e){console.log(" date.length:"+e.length),this.visible=!0;for(var t=0;t<e.length;t++)Statics.ScoreDate.push({date:"",time:"",roomId:"",playerOneName:"",playerOneValue:"",playerTwoName:"",playerTwoValue:"",playerThreeName:"",playerThreeValue:"",playerFourName:"",playerFourValue:""});for(var t=0;t<e.length;t++)console.log(" Statics.ScoreDate[i].date:"+Statics.ScoreDate[t].date),Statics.ScoreDate[t].date=e[t].date,Statics.ScoreDate[t].time=e[t].time,Statics.ScoreDate[t].roomId=e[t].roomId,Statics.ScoreDate[t].playerOneName=e[t].playerOneName,Statics.ScoreDate[t].playerOneValue=e[t].playerOneValue,Statics.ScoreDate[t].playerTwoName=e[t].playerTwoName,Statics.ScoreDate[t].playerTwoValue=e[t].playerTwoValue,Statics.ScoreDate[t].playerThreeName=e[t].playerThreeName,Statics.ScoreDate[t].playerThreeValue=e[t].playerThreeValue,Statics.ScoreDate[t].playerFourName=e[t].playerFourName,Statics.ScoreDate[t].playerFourValue=e[t].playerFourValue;this.list_score.height=106*e.length},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this&&this.parent&&this.parent.removeChild(this)},t.prototype.onShare=function(){console.log("分享战绩")},t}(eui.Component);__reflect(Page_Score.prototype,"Page_Score");var Page_Score_Singe=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageScoreSingSkin.exml",t}return __extends(t,e),t}(eui.ItemRenderer);__reflect(Page_Score_Singe.prototype,"Page_Score_Singe");var Page_Server=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageServerSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this)},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this&&this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(Page_Server.prototype,"Page_Server");var Page_Set=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageSetSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.rect_touch.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.ts_sound.addEventListener(egret.Event.CHANGE,this.onEffectChanged,this),this.ts_music.addEventListener(egret.Event.CHANGE,this.onSoundChanged,this),this.init()},t.prototype.init=function(){this.ts_music.selected=Sound.isPlay,this.ts_sound.selected=0==Sound.getInstance().effectVolume?!1:!0},t.prototype.onEffectChanged=function(e){e.target.selected?Sound.getInstance().effectVolume=.8:Sound.getInstance().effectVolume=0},t.prototype.onSoundChanged=function(e){Sound.isPlay=e.target.selected,Sound.getInstance().Switch=e.target.selected},t.prototype.onRemoveStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.rect_touch.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.ts_sound.removeEventListener(egret.Event.CHANGE,this.onEffectChanged,this),this.ts_music.removeEventListener(egret.Event.CHANGE,this.onSoundChanged,this),this&&this.parent&&this.parent.removeChild(this),egret.localStorage.setItem("kdmj_music",JSON.stringify([this.ts_music.selected,this.ts_sound.selected]))},t}(eui.Component);__reflect(Page_Set.prototype,"Page_Set");var Page_Shop=function(e){function t(){var t=e.call(this)||this;return t.payIndex=0,t.buyMonenyAry=[10,20,30,50,80,100],t.skinName="resource/skins/page/PageShopSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this);for(var e=1;7>e;e++)this["btn_pay"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickPay,this);this.btn_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuy,this),this.PayName1.text="￥"+Room.rechargeInfo.base_one,this.PayName2.text="￥"+Room.rechargeInfo.base_two,this.PayName3.text="￥"+Room.rechargeInfo.base_three,this.PayName4.text="￥"+Room.rechargeInfo.base_four,this.PayName5.text="￥"+Room.rechargeInfo.base_five,this.PayName6.text="￥"+Room.rechargeInfo.base_six,this.PayBao1.text=Room.rechargeInfo.base_one+"元宝",this.PayBao2.text=Room.rechargeInfo.base_two+"元宝",this.PayBao3.text=Room.rechargeInfo.base_three+"元宝",this.PayBao4.text=Room.rechargeInfo.base_four+"元宝",this.PayBao5.text=Room.rechargeInfo.base_five+"元宝",this.PayBao6.text=Room.rechargeInfo.base_six+"元宝",this.buyMonenyAry=[],this.buyMonenyAry.push(parseInt(Room.rechargeInfo.base_one)),this.buyMonenyAry.push(parseInt(Room.rechargeInfo.base_two)),this.buyMonenyAry.push(parseInt(Room.rechargeInfo.base_three)),this.buyMonenyAry.push(parseInt(Room.rechargeInfo.base_four)),this.buyMonenyAry.push(parseInt(Room.rechargeInfo.base_five)),this.buyMonenyAry.push(parseInt(Room.rechargeInfo.base_six)),"0"!=Player.recommandCode&&(this.RecommandCodeText.visible=!0,this.RecommandCodeText.text="您绑定的推荐码："+Player.recommandCode),this.SongPage1.SongText.text="+"+Room.rechargeInfo.base_one_give,this.SongPage2.SongText.text="+"+Room.rechargeInfo.base_two_give,this.SongPage3.SongText.text="+"+Room.rechargeInfo.base_three_give,this.SongPage4.SongText.text="+"+Room.rechargeInfo.base_four_give,this.SongPage5.SongText.text="+"+Room.rechargeInfo.base_five_give,this.SongPage6.SongText.text="+"+Room.rechargeInfo.base_six_give},t.prototype.onRemoveStage=function(){this.onResetGou(),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this);for(var e=1;7>e;e++)this["btn_pay"+e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickPay,this);this&&this.parent&&this.parent.removeChild(this)},t.prototype.onResetGou=function(){for(var e=1;7>e;e++)this["img_gou"+e].visible=!1,this["SongPage"+e].visible=!1,this["SongPage"+e].RomoveAni()},t.prototype.onClickPay=function(e){this.onResetGou(),this.payIndex=e.target.name.substr(3,4),console.log("充钱："+this.buyMonenyAry[parseInt(e.target.name.substr(3,4))-1]),this["img_gou"+this.payIndex].visible=!0,"0"!=Player.recommandCode&&(this["SongPage"+this.payIndex].visible=!0,this["SongPage"+this.payIndex].ShowAni())},t.prototype.onBuy=function(){return console.log("购买"),0==this.payIndex?void this.addChild(new AlertPage("请选择购买的金额！")):void 0},t}(eui.Component);__reflect(Page_Shop.prototype,"Page_Shop");var Page_UserInfo=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageUserInfoSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.left=this.right=this.top=this.bottom=0,this.img_head.mask=this.headMask,this.lb_nickname.text=Player.NickName,this.lb_id.text="ID:"+Player.ID,this.lb_money.text=HallUserPage.PlayerScore.toString(),this.img_head.source=Player.HeadImg;var e=JSON.parse(decodeURIComponent(egret.getOption("player")));e&&(this.lb_ip.text="IP:"+e.ip,this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.btn_head_add.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAdd,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this))},t.prototype.updateUsersinfo=function(){this.lb_nickname.text=Player.NickName,this.lb_id.text="ID:"+Player.ID,this.lb_money.text=HallUserPage.PlayerScore.toString(),this.img_head.source=Player.HeadImg},t.prototype.onRemoveStage=function(){this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this&&this.parent&&this.parent.removeChild(this)},t.prototype.onAdd=function(){this.onRemoveStage(),Global.mainScene.onCreateShop()},t}(eui.Component);__reflect(Page_UserInfo.prototype,"Page_UserInfo");var Page_UserInfoer=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/page/PageUserInfoerSkin.exml",t}return __extends(t,e),t.prototype.childrenCreateder=function(e,t,i,n){this.left=this.right=this.top=this.bottom=0,this.img_head.mask=this.headMask,this.lb_nickname.text=e,this.lb_id.text="ID:"+t,this.img_head.source=i;var o=JSON.parse(decodeURIComponent(egret.getOption("player")));o&&(this.lb_ip.text="IP:"+n,this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this))},t.prototype.updateUsersinfo=function(){this.lb_nickname.text=Player.NickName,this.lb_id.text="ID:"+Player.ID,this.img_head.source=Player.HeadImg},t.prototype.onRemoveStage=function(){this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRemoveStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveStage,this),this&&this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(Page_UserInfoer.prototype,"Page_UserInfoer");var SongPage=function(e){function t(){var t=e.call(this)||this;return t.skinName="SongPageSkin",t.init(),t}return __extends(t,e),t.prototype.init=function(){},t.prototype.ShowAni=function(){var e=this,t=egret.Tween.get(this);t.to({alpha:0},500).to({alpha:1},500).call(function(){e.ShowAni()},this)},t.prototype.RomoveAni=function(){egret.Tween.removeTweens(this)},t}(eui.Component);__reflect(SongPage.prototype,"SongPage");var Select_CheckBox=function(e){function t(){var t=e.call(this)||this;return t._isSelected=!1,t.skinName="resource/skins/select/CheckSkin.exml",t}return __extends(t,e),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this._isSelected},set:function(e){this._isSelected=e,e?this.img_select.source=RES.getRes("icon_select2_yes_png"):this.img_select.source=RES.getRes("icon_select2_no_png")},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(Select_CheckBox.prototype,"Select_CheckBox");var Select_Radio=function(e){function t(){var t=e.call(this)||this;return t._isSelected=!1,t.skinName="resource/skins/select/RadioSkin.exml",t}return __extends(t,e),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this._isSelected},set:function(e){this._isSelected=e,e?this.img_select.source=RES.getRes("icon_select_yes_png"):this.img_select.source=RES.getRes("icon_select_no_png")},enumerable:!0,configurable:!0}),t.prototype.childrenCreated=function(){},t}(eui.Component);__reflect(Select_Radio.prototype,"Select_Radio");var HSlider=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/HSliderSkin.exml",t}return __extends(t,e),t}(eui.HSlider);__reflect(HSlider.prototype,"HSlider");var FishUtil=function(){function e(){}return e.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},e.createRect=function(e,t,i,n,o){var a=new egret.Shape,r=a.graphics;return r.beginFill(o),r.drawRect(e,t,i,n),r.endFill(),a},e.createCircle=function(e,t,i,n){var o=new egret.Shape,a=o.graphics;return a.beginFill(n),a.drawCircle(e,t,i),a.endFill(),o},e.createMovieClipByName=function(e){var t=new egret.MovieClip;console.log(e);var i=RES.getRes(e+"_json"),n=RES.getRes(e+"_png"),o=new egret.MovieClipDataFactory(i,n);return t=new egret.MovieClip(o.generateMovieClipData(e))},e.createRandom=function(e,t){var i=Math.floor(Math.random()*(t-e+1))+e;return i},e.createErWeiMa=function(t,i,n){e.gameDiv=document.getElementById("gameDiv"),e.myImg=document.createElement("img");var o=document.body.clientWidth,a=document.body.clientHeight,r=o*t,s=(o-r)/2,h=a*i;e.myImg.src=n,e.myImg.style.width=r+"px",e.myImg.style.left=s+"px",e.myImg.style.top=h+"px",e.myImg.style.position="absolute",e.gameDiv.appendChild(e.myImg)},e.removeErWeiMa=function(){e.myImg&&e.myImg.src&&e.gameDiv.removeChild(e.myImg)},e.getStringLength=function(e){for(var t=0,i=0;i<e.length;i++)e.charCodeAt(i)>255?t+=2:t++;return t},e.HitCheck=function(e,t){var i=new egret.Rectangle(e.x,e.y,e.width,e.height),n=new egret.Rectangle(t.x,t.y,t.width,t.height);return i.intersects(n)},e.getNowFormatDate=function(){var e=new Date,t="-",i=":",n=e.getMonth()+1,o=e.getDate();n>=1&&9>=n&&(n="0"+n),o>=0&&9>=o&&(o="0"+o);var a=e.getFullYear()+t+n+t+o+" "+e.getHours()+i+e.getMinutes()+i+e.getSeconds();return a},e.SetFullScene=function(e){e.top=e.bottom=e.left=e.right=0},e.InsertSort=function(e){for(var t=1,i=void 0;t<e.length;t++){i=t;for(var n=e[i];e[i-1]>n&&(e[i]=e[i-1],i--,0!=i););e[i]=n}return e},e.limitNick=function(e,t){if(void 0===t&&(t=10),e.replace(/[^\x00-\xff]/g,"aa").length>t){for(var i=0,n=e.length,o=0;n>o&&(0!=(65280&e.charCodeAt(o))&&i++,i++,!(i>t));o++);e=e.slice(0,o)+"..."}return e},e}();__reflect(FishUtil.prototype,"FishUtil");var WeixinUtil=function(){function e(){}return e.prototype.initWeixinInfo=function(t,i,n,o){void 0===n&&(n=""),"刚刚大战一场，看我战绩如何"==t?this._imgUrl="http://a3.qpic.cn/psb?/V12MduwF1owQeS/fUGmOJKorZFkgNTZK77YI5k9Is8Ht9HWX.rihtXS.Mk!/b/dG0BAAAAAAAA&bo=yADIAAAAAAARBzA!&rf=viewer_4":this._imgUrl="http://a3.qpic.cn/psb?/V12MduwF1owQeS/fUGmOJKorZFkgNTZK77YI5k9Is8Ht9HWX.rihtXS.Mk!/b/dG0BAAAAAAAA&bo=yADIAAAAAAARBzA!&rf=viewer_4",this.share_success=o;var a=window.location.href,r=encodeURIComponent(a);""==n?this._link="http://hdmj.vequn.org":this._link="http://hdmj.vequn.org"+n,this._title=t,this._desc=i;var s=e.netAddr,h=new egret.URLLoader;h.dataFormat=egret.URLLoaderDataFormat.TEXT,h.addEventListener(egret.Event.COMPLETE,this.onGet_WeiXinComplete,this);var c=new egret.URLRequest(s);c.method=egret.URLRequestMethod.GET,c.data=new egret.URLVariables("url="+r),h.load(c)},e.prototype.successShare=function(){},e.prototype.onGet_WeiXinComplete=function(t){var i=this,n=JSON.parse(t.target.data);e.wxOpenId=n.openid,e.wxHeadImg=n.headimgurl,e.wxNickName=n.nickname,e.bodyConfig=new BodyConfig,e.bodyConfig.appId=n.appId,e.bodyConfig.debug=!1,e.bodyConfig.timestamp=n.timestamp,e.bodyConfig.nonceStr=n.nonceStr,e.bodyConfig.signature=n.signature,e.bodyConfig.jsApiList=["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","onRecordEnd","playVoice","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"],wx.config(e.bodyConfig),wx.ready(function(){wx.hideMenuItems({menuList:["menuItem:copyUrl","menuItem:share:email","menuItem:openWithQQBrowser","menuItem:share:email","menuItem:openWithSafari"]}),wx.showMenuItems({menuList:["menuItem:refresh","menuItem:share:appMessage","menuItem:share:timeline"]}),e.appInfo=new BodyMenuShareAppMessage,e.appInfo.title=i._title,e.appInfo.desc=i._desc,e.appInfo.link=i._link,console.log(i._imgUrl),console.log(i._desc),e.appInfo.imgUrl=i._imgUrl,e.appInfo.type="link",e.appInfo.success=function(){null!=i.share_success&&i.share_success()},wx.onMenuShareAppMessage(e.appInfo),e.timelineInfo=new BodyMenuShareTimeline,e.timelineInfo.imgUrl=i._imgUrl,e.timelineInfo.link=i._link,e.timelineInfo.title=i._title,e.timelineInfo.success=function(){null!=i.share_success&&i.share_success()},wx.onMenuShareTimeline(e.timelineInfo)})},e.prototype.initPayWeiXinInfo=function(t,i,n){var o=window.location.href,a=encodeURIComponent(o);this.Pay_success=n;var r=e.netPayAddr+"?playerId="+t+"&amount="+i,s=new egret.URLLoader;s.dataFormat=egret.URLLoaderDataFormat.TEXT,s.addEventListener(egret.Event.COMPLETE,this.onGet_PaynComplete,this);var h=new egret.URLRequest(r);h.method=egret.URLRequestMethod.GET,h.data=new egret.URLVariables("url="+a),s.load(h)},e.prototype.onGet_PaynComplete=function(t){this._payJson=JSON.parse(t.target.data);var i=this._payJson.obj,n=i["package"].split("=");Player.preparId=n[1];var o=window.location.href,a=encodeURIComponent(o),r=e.netAddr,s=new egret.URLLoader;s.dataFormat=egret.URLLoaderDataFormat.TEXT,s.addEventListener(egret.Event.COMPLETE,this.onGet_WeiXinPayComplete,this);var h=new egret.URLRequest(r);h.method=egret.URLRequestMethod.GET,h.data=new egret.URLVariables("url="+a),s.load(h)},e.prototype.onGet_WeiXinPayComplete=function(e){var t=this,i=JSON.parse(e.target.data);if(wx){var n=new BodyConfig;n.debug=!1,n.appId=i.appId.toString(),n.timestamp=i.timestamp.toString(),n.nonceStr=i.nonceStr.toString(),n.signature=i.signature.toString(),n.jsApiList=["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","chooseImage","uploadImage","getNetworkType","openLocation","getLocation","closeWindow","chooseWXPay"],wx.config(n),wx.ready(function(){var e=t._payJson.obj;wx.chooseWXPay({timestamp:e.timeStamp+"",nonceStr:e.nonceStr,"package":e["package"],signType:"MD5",paySign:e.paySign,success:function(){null!=t.Pay_success&&t.Pay_success()},cancel:function(e){},fail:function(e){alert("请求支付失败")}})}),wx.error(function(){})}},e.prototype.onWxPay=function(e,t,i,n,o,a){wx.ready(function(){wx.chooseWXPay({appId:e,timestamp:t,nonceStr:i,"package":n,paySign:o,signType:a,success:function(e){},fail:function(e){}})})},e.prototype.InitRecord=function(){var t=window.location.href,i=encodeURIComponent(t),n=e.netAddr,o=new egret.URLLoader;o.dataFormat=egret.URLLoaderDataFormat.TEXT,o.addEventListener(egret.Event.COMPLETE,this.OnGetRecordComplete,this);var a=new egret.URLRequest(n);a.method=egret.URLRequestMethod.GET,a.data=new egret.URLVariables("url="+i),o.load(a)},e.prototype.ReadInitRecord=function(){var t=window.location.href,i=encodeURIComponent(t),n=e.netAddr,o=new egret.URLLoader;o.dataFormat=egret.URLLoaderDataFormat.TEXT,o.addEventListener(egret.Event.COMPLETE,this.OnGetReadIRecordComplete,this);var a=new egret.URLRequest(n);a.method=egret.URLRequestMethod.GET,a.data=new egret.URLVariables("url="+i),o.load(a)},e.prototype.OnGetReadIRecordComplete=function(t){var i=JSON.parse(t.target.data);e.wxOpenId=i.openid,e.wxHeadImg=i.headimgurl,e.wxNickName=i.nickname,e.bodyConfig=new BodyConfig,e.bodyConfig.appId=i.appId,e.bodyConfig.debug=!1,e.bodyConfig.timestamp=i.timestamp,e.bodyConfig.nonceStr=i.nonceStr,e.bodyConfig.signature=i.signature,e.bodyConfig.jsApiList=["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","onRecordEnd","playVoice","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"],wx.config(e.bodyConfig)},e.prototype.ShowRecord=function(e){wx.playVoice({localId:e}),this.onVoicePlayEnd()},e.prototype.OnGetRecordComplete=function(t){var i=JSON.parse(t.target.data);e.wxOpenId=i.openid,e.wxHeadImg=i.headimgurl,e.wxNickName=i.nickname,e.bodyConfig=new BodyConfig,e.bodyConfig.appId=i.appId,e.bodyConfig.debug=!1,e.bodyConfig.timestamp=i.timestamp,e.bodyConfig.nonceStr=i.nonceStr,e.bodyConfig.signature=i.signature,e.bodyConfig.jsApiList=["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","onRecordEnd","playVoice","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","onVoicePlayEnd","openCard"],wx.config(e.bodyConfig)},e.prototype.onVoicePlayEnd=function(){wx.onVoicePlayEnd({success:function(e){console.log("播放结束"),Global.mainScene.HideRecord()},fail:function(e){}})},e.prototype.onStartRecord=function(){wx.startRecord({cancel:function(){alert("用户拒绝授权录音")},success:function(){var e=egret.localStorage.getItem("IsFirst");(null==e||""==e||void 0==e)&&("Android"==egret.Capabilities.os?this.onStopRecord():egret.localStorage.setItem("IsFirst","false"))}})},e.prototype.onStopRecord=function(){wx.stopRecord({success:function(e){var t=egret.localStorage.getItem("IsFirst");if(null==t||""==t||void 0==t)"Android"==egret.Capabilities.os&&egret.localStorage.setItem("IsFirst","false");else{this.localId=e.localId;var i=this.localId;Global.GameVoice=i}},fail:function(e){alert(JSON.stringify(e))}})},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.uploadVoice=function(){wx.uploadVoice({localId:Global.GameVoice,isShowProgressTips:0,success:function(e){e.serverId}})},e.prototype.uploadVoice2=function(){var e=Global.GameVoice;-1!=e.indexOf("wxlocalresource")&&(e=e.replace("wxlocalresource","wxLocalResource")),wx.uploadVoice({localId:e,isShowProgressTips:0,success:function(e){var t=e.serverId;Global.GameVoiceServer=t;var i={cmd:NetData.CODE_Game_Record,msg:[{record:JSON.stringify(Global.GameVoiceServer),roomId:Room.NUMBER}]};SocketUtil.getInstance().onSendMessage(i)}})},e.prototype.downloadVoice=function(){wx.downloadVoice({serverId:Global.GameVoiceServer,isShowProgressTips:0,success:function(e){e.localId}})},e.netAddr="http://hdmj.vequn.org/share",e.netPayAddr="http://hdmj.vequn.org/payServlet",e}();__reflect(WeixinUtil.prototype,"WeixinUtil");